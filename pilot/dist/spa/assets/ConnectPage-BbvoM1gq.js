import{Q as ve}from"./QSpace-PKGevyI_.js";import{Q as K}from"./QBtnDropdown-C8isYOqo.js";import{Q as J}from"./QCheckbox-jdRwq7G5.js";import{Q as R}from"./QCircularProgress-Cpj-5jfY.js";import{Q as f,a}from"./QItem-0kfMxV0x.js";import{d as ee,q as te,B as j,E as p,F as t,J as u,K as y,I as e,Q as x,M as l,Y as A,R as g,N as r,H as c,c as h,z as be,w as Y,O as W,P as w,T as ye,S as Pe,Z as T}from"./index-czUYoKoi.js";import{Q as E}from"./QBadge-9ENvPwsT.js";import{Q as _}from"./QItemLabel-DFzFiUme.js";import{Q as P}from"./QInput-DAgdV14D.js";import{Q as F}from"./QList-D_7_muqa.js";import{Q as O}from"./QCard-JtAeCRES.js";import{Q as Z}from"./QSelect-D57SO3hy.js";import{Q as Ae}from"./QPage-DT5uZUA-.js";import{u as le}from"./use-quasar-C_dZaDjE.js";import{u as oe}from"./device-CBd1NEAG.js";import{u as ne}from"./config-BzivkgyD.js";import{u as we,p as he}from"./status-BqoJPY4U.js";import{d as L}from"./angles-CM-dTGcw.js";import{Q as k}from"./QToggle-3TBp_QiG.js";import{Q as X}from"./QBanner-C9-dHvy_.js";import"./QBtnGroup-BoKT3XEg.js";import"./QMenu-BZAKKC3w.js";import"./position-engine-CM2bfKFz.js";import"./selection-jC7aCOuj.js";import"./focus-manager-BFhRSJxH.js";import"./use-model-toggle-DkUlaMca.js";import"./use-dark-P7KIkx42.js";import"./use-timeout-gEiGojfv.js";import"./use-key-composition-CHEtNdfV.js";import"./use-checkbox-CRI_mhqU.js";import"./format-BvkBI9bc.js";import"./QChip-CAMRUd09.js";import"./use-prevent-scroll-D_JN3c-5.js";import"./rtl-DFPa-2ov.js";const Ce={class:"row"},ke={class:"q-gutter-md flex justify-end q-mr-md"},xe={class:"col-auto q-gutter-sm flex justify-end items-center"},Se={class:"row q-col-gutter-sm no-wrap"},qe={class:"row q-col-gutter-sm no-wrap"},Ie={class:"row q-col-gutter-sm no-wrap"},Ve={class:"row q-col-gutter-sm no-wrap"},Qe={class:"row q-col-gutter-sm no-wrap"},Be={class:"row q-col-gutter-sm no-wrap"},Ue=ee({__name:"NetworkSettings",setup(se){const S=le(),s=oe(),d=ne();te(async()=>{s.restAPIConnected&&s.restAPIConnectedAt&&d.fetchedAt<s.restAPIConnectedAt&&await d.configFetch()});function n(v,b,B){const U=d[v],C=typeof U,$=["string","number","boolean"].includes(C),H=C==="boolean";return{label:b,modelValue:$?U:"","onUpdate:modelValue":q=>{if(q!==null&&$){d[v]=q;const D={[v]:q};H?V(D):I(D)}}}}const I=j(v=>d.configUpdate(v),500),V=j(v=>d.configUpdate(v),5);async function Q(){const v=await d.configSave();S.notify({message:`Configuration save ${v?"successful":"unsucessful"}.`,type:v?"positive":"negative",position:"top",timeout:3e3,actions:[{icon:"mdi-close",color:"white"}]})}return(v,b)=>(c(),p(O,{flat:"",bordered:"",class:"q-pa-md"},{default:t(()=>[b[3]||(b[3]=u("div",{class:"text-h6"},"Alpaca Network Services",-1)),u("div",Ce,[b[0]||(b[0]=u("div",{class:"col text-caption text-grey-6 q-pb-md"}," The Alpaca Driver provides several network services for external aplications to use the Benro Polaris. Changes to Network Services require saving to take effect. ",-1)),u("div",ke,[u("div",xe,[e(x,{rounded:"",color:"grey-9",label:"Save",onClick:Q,disable:l(d).isSaving,loading:l(d).isSaving},null,8,["disable","loading"])])])]),u("div",Se,[e(k,A({class:"col-8"},n("enable_restapi","Alpaca REST API Service")),null,16),e(P,A({class:"col-4"},n("alpaca_restapi_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_restapi?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),l(d).enable_restapi?y("",!0):(c(),p(X,{key:0,"inline-actions":"",rounded:"",class:"bg-warning"},{default:t(()=>b[1]||(b[1]=[r(" WARNING: The Alpaca REST API is required for Nina, Stellarium and Alpaca Pilot. ",-1)])),_:1,__:[1]})),l(d).alpaca_restapi_port!=l(s).restAPIPort?(c(),p(X,{key:1,"inline-actions":"",rounded:"",class:"bg-warning"},{default:t(()=>b[2]||(b[2]=[r(" WARNING: The Alpaca REST API port will change. Please reconnect Alpaca Pilot when prompted. ",-1)])),_:1,__:[2]})):y("",!0),u("div",qe,[e(k,A({class:"col-8"},n("enable_discovery","Alpaca Discovery Service")),null,16),e(P,A({class:"col-4"},n("alpaca_discovery_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_discovery?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Ie,[e(k,A({class:"col-8"},n("enable_pilot","Alpaca Pilot Webserver")),null,16),e(P,A({class:"col-4"},n("alpaca_pilot_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_pilot?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Ve,[e(k,A({class:"col-8"},n("enable_socket","Alpaca Pilot Socket IO")),null,16),e(P,A({class:"col-4"},n("alpaca_socket_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_socket?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Qe,[e(k,A({class:"col-8"},n("enable_synscan","SynSCAN API Service")),null,16),e(P,A({class:"col-4"},n("stellarium_synscan_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_synscan?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Be,[e(k,A({class:"col-8"},n("polaris_auto_retry","Auto Retry Polaris Connection")),null,16)])]),_:1,__:[3]}))}}),$e={class:"row q-pb-sm q-col-gutter-md items-center"},De={class:"col text-h6 q-ml-md"},Ne={key:0,class:"text-caption text-grey-6"},ze={class:"q-gutter-md flex justify-end q-mr-md"},Me={class:"row q-col-gutter-sm items-stretch"},Re={class:"col-12 col-md-6 flex"},We={class:"text-h6"},Te={class:"q-gutter-sm q-pl-sm"},Ee={class:"row items-start"},Fe={key:0,class:"col-12 col-md-6 flex"},He={class:"text-h6"},Ke={class:"q-mt-md q-pl-lg"},Le={class:"q-gutter-sm q-pl-sm"},je={key:2},Oe={class:"row items-start"},Ge={class:"row items-center q-gutter-sm"},Je={class:"row items-center q-gutter-sm"},Qt=ee({__name:"ConnectPage",setup(se){const S=le(),s=oe(),d=ne(),n=we(),I=h({get:()=>s.alpacaHost,set:i=>s.setAlpacaHost(i)}),V=h({get:()=>s.restAPIPort,set:i=>s.setRestAPIPort(Number(i))}),Q=h(()=>n.aligned_count>=3),v=h(()=>n.bledevices.length),b=h(()=>!!n.bleselected&&v.value>0),B=h(()=>!!n.connected),U=h(()=>v.value==0?"Check Power or Bluetooth, no devices discovered.":v.value>1?"Multiple devices discovered.":b.value?"":"Please select device."),C=h(()=>n.polarismode==8),$=h(()=>C.value?"":"Change Polaris Mode to Astro.");te(async()=>{}),be(()=>{});async function H(i){await s.bleSelectDevice(i)}async function q(){await s.bleEnableWifi()}async function D(){console.log("Polaris Reset Axes"),await s.alpacaResetAxes()}async function ae(i="180.0"){const o=L(i,"deg");console.log("Set Compass Alignment to ${bearing}"),await s.setPolarisCompass(o)}async function ie(i="180.0",o="45.0"){const m=L(i,"deg"),ge=L(o,"deg");console.log("Set Alignment Alignment Az ${az}, Alt ${alt}"),await s.setPolarisAlignment(m,ge)}async function de(i){console.log("Polaris Mode",i),n.polarismode=i,await s.setPolarisMode(i)}async function re(i){i&&!s.restAPIConnected?await N():!i&&s.restAPIConnected&&ue()}Y(()=>s.restAPIConnected,async i=>{i&&(await d.configFetch(),S.notify({message:"Alpaca Driver successfuly connected.",type:"positive",position:"top",timeout:3e3,actions:[{icon:"mdi-close",color:"white"}]}))});async function N(){s.restAPIConnected||await s.connectRestAPI()}function ue(){s.restAPIConnected&&s.disconnectRestAPI()}async function ce(i){i&&!n.connected?await z():!i&&n.connected&&await me()}Y(()=>n.connected,i=>{i&&S.notify({message:"Benro Polaris successfuly connected.",type:"positive",position:"top",timeout:3e3,actions:[{icon:"mdi-close",color:"white"}]})});async function z(){console.log("Connecting to Polaris"),n.connected||await s.connectPolaris()}async function me(){console.log("Disconnect Polaris"),n.connected&&await s.disconnectPolaris()}function pe(i){M({polaris_ip_address:i})}function fe(i){M({polaris_port:i})}function G(i){M({default_azimuth:i})}function _e(i){M({default_altitude:i})}const M=j(i=>d.configUpdate(i),500);return(i,o)=>(c(),p(Ae,{class:"q-pa-sm"},{default:t(()=>[u("div",$e,[u("div",De,[o[11]||(o[11]=r(" Device Connections ",-1)),l(S).screen.gt.xs?(c(),W("div",Ne," Connect to the Alpaca Driver and Benro Polaris. ")):y("",!0)]),e(ve),u("div",ze,[e(K,{rounded:"",color:"grey-9",label:"Network Services","content-style":{width:"600px"}},{default:t(()=>[e(Ue)]),_:1})])]),u("div",Me,[u("div",Re,[e(O,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:t(()=>[u("div",We,[e(J,{label:"Connect to Alpaca Driver",color:"positive","model-value":l(s).restAPIConnected,"onUpdate:modelValue":re},null,8,["model-value"])]),e(F,{class:"q-pl-lg"},{default:t(()=>[l(s).restAPIConnectingMsg?(c(),p(f,{key:0},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(R,{indeterminate:"",rounded:"",size:"lg",color:"positive"})]),_:1}),e(a,null,{default:t(()=>[r(w(l(s).restAPIConnectingMsg),1)]),_:1})]),_:1})):l(s).restAPIConnected?(c(),p(f,{key:1},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-check-circle",color:"green"})]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>[r(w(l(s).alpacaServerName)+" ",1),u("span",Te,[e(E,null,{default:t(()=>[r("v"+w(l(s).alpacaServerVersion),1)]),_:1}),(c(!0),W(Pe,null,ye(l(s).alpacaDevices,m=>(c(),p(E,{key:m,color:"positive"},{default:t(()=>[r(w(m),1)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})):(c(),p(f,{key:2},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-alert-circle",color:"red"})]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[12]||(o[12]=[r("Alpaca Driver Connection Problem",-1)])),_:1,__:[12]}),e(_,{caption:""},{default:t(()=>[r(w(l(s).restAPIConnectErrorMsg),1)]),_:1})]),_:1}),l(s).restAPIConnected?y("",!0):(c(),p(a,{key:0,side:""},{default:t(()=>[e(x,{label:"Connect",icon:"mdi-wifi",onClick:N,class:"fixedWidth"})]),_:1}))]),_:1})),!l(s).restAPIConnected&&!l(s).restAPIConnectingMsg?(c(),p(f,{key:3,"inset-level":.5},{default:t(()=>[e(a,null,{default:t(()=>[u("div",Ee,[e(P,{class:"col-8",modelValue:I.value,"onUpdate:modelValue":o[0]||(o[0]=m=>I.value=m),onKeyup:T(N,["enter"]),label:"Host Name / IP Address"},null,8,["modelValue"]),e(P,{class:"col-4",label:"Port",modelValue:V.value,"onUpdate:modelValue":o[1]||(o[1]=m=>V.value=m),onKeyup:T(N,["enter"]),type:"number","input-class":"text-right"},{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})]),l(s).restAPIConnected?(c(),W("div",Fe,[e(O,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:t(()=>[u("div",He,[e(J,{"model-value":l(n).connected,"onUpdate:modelValue":ce,color:"positive",label:"Connect Driver to Benro Polaris"},null,8,["model-value"])]),u("div",Ke,[e(F,null,{default:t(()=>[e(f,null,{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:b.value?"mdi-check-circle":"mdi-alert-circle",color:b.value?"green":"red"},null,8,["name","color"])]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[13]||(o[13]=[r("Select Benro Polaris",-1)])),_:1,__:[13]}),e(_,{caption:""},{default:t(()=>[r(w(U.value),1)]),_:1})]),_:1}),v.value>0?(c(),p(a,{key:0,side:""},{default:t(()=>[e(Z,{label:"Device",modelValue:l(n).bleselected,"onUpdate:modelValue":[o[2]||(o[2]=m=>l(n).bleselected=m),H],options:l(n).bledevices,dense:"","options-dense":"","display-value":`${b.value?l(n).bleselected:"Unselected"}`,color:"secondary"},{before:t(()=>[l(n).bleisenablingwifi?(c(),p(R,{key:0,indeterminate:"",rounded:"",size:"sm",color:"primary"})):(c(),p(x,{key:1,round:"",dense:"",flat:"",icon:"mdi-wifi-sync",color:l(n).bleiswifienabled?"primary":"white",onClick:q},null,8,["color"]))]),_:1},8,["modelValue","options","display-value"])]),_:1})):y("",!0)]),_:1}),l(n).connecting&&l(n).bleselected?(c(),p(f,{key:0},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(R,{indeterminate:"",rounded:"",size:"lg",color:"positive"})]),_:1}),e(a,null,{default:t(()=>o[14]||(o[14]=[r("Connecting...",-1)])),_:1,__:[14]})]),_:1})):B.value?(c(),p(f,{key:1},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-check-circle",color:"green"})]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>[o[15]||(o[15]=r(" Benro Polaris ",-1)),u("span",Le,[e(E,null,{default:t(()=>[r("hw v"+w(l(n).polarishwver),1)]),_:1}),e(E,null,{default:t(()=>[r("sw v"+w(l(n).polarisswver),1)]),_:1})])]),_:1,__:[15]})]),_:1})]),_:1})):b.value?(c(),W("div",je,[e(f,null,{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-alert-circle",color:"red"})]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[16]||(o[16]=[r("Benro Polaris Connection Problem",-1)])),_:1,__:[16]}),e(_,{caption:""},{default:t(()=>[r(w(l(n).connectionmsg),1)]),_:1})]),_:1}),e(a,{side:""},{default:t(()=>[e(x,{label:"Connect",icon:"mdi-wifi",onClick:z,class:"fixedWidth"})]),_:1})]),_:1}),e(f,{"inset-level":.5},{default:t(()=>[e(a,null,{default:t(()=>[u("div",Oe,[e(P,{class:"col-8 q-pt-none",label:"Host Name / IP Address",modelValue:l(d).polaris_ip_address,"onUpdate:modelValue":[o[3]||(o[3]=m=>l(d).polaris_ip_address=m),pe],onKeyup:T(z,["enter"])},null,8,["modelValue"]),e(P,{class:"col-4",label:"Port",type:"number","input-class":"text-right",modelValue:l(d).polaris_port,"onUpdate:modelValue":[o[4]||(o[4]=m=>l(d).polaris_port=m),fe],onKeyup:T(z,["enter"])},{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})])):y("",!0),l(n).connected?(c(),p(f,{key:3},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:C.value?"mdi-check-circle":"mdi-alert-circle",color:C.value?"green":"red"},null,8,["name","color"])]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[17]||(o[17]=[r("Select Astro Mode",-1)])),_:1,__:[17]}),e(_,{caption:""},{default:t(()=>[r(w($.value),1)]),_:1})]),_:1}),e(a,{side:""},{default:t(()=>[e(Z,{label:"Mode",modelValue:l(n).polarismode,"onUpdate:modelValue":[o[5]||(o[5]=m=>l(n).polarismode=m),de],options:l(he),"display-value":`${l(n).polarismodestr}`,"emit-value":"","map-options":"",dense:"","options-dense":"",class:"fixedWidth",color:"secondary"},{default:t(()=>[u("template",null,[e(g,{name:"mdi-satellite-variant"})])]),_:1},8,["modelValue","options","display-value"])]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:4},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:B.value?"mdi-check-circle":"mdi-alert-circle",color:B.value?"green":"red"},null,8,["name","color"])]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[18]||(o[18]=[r("Reset all Polaris Axes",-1)])),_:1,__:[18]})]),_:1}),e(a,{side:""},{default:t(()=>[e(x,{label:"Reset",icon:"mdi-backup-restore",class:"fixedWidth",onClick:D})]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:5},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:l(n).compassed?"mdi-check-circle":"mdi-alert-circle",color:l(n).compassed?"green":"red"},null,8,["name","color"])]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[19]||(o[19]=[r("Compass Alignment",-1)])),_:1,__:[19]})]),_:1}),e(a,{side:""},{default:t(()=>[e(K,{label:"Skip",split:"",icon:"mdi-compass",onClick:o[7]||(o[7]=m=>ae(l(d).default_azimuth)),class:"fixedWidth"},{default:t(()=>[e(F,{dense:"",class:"q-mt-md q-mb-md"},{default:t(()=>[e(f,null,{default:t(()=>[e(a,null,{default:t(()=>[e(_,{caption:""},{default:t(()=>o[20]||(o[20]=[r("Use this default.",-1)])),_:1,__:[20]}),e(_,{caption:""},{default:t(()=>o[21]||(o[21]=[r("Plate solve later.",-1)])),_:1,__:[21]})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(P,{label:"Azimuth (deg:mm:ss)",modelValue:l(d).default_azimuth,"onUpdate:modelValue":[o[6]||(o[6]=m=>l(d).default_azimuth=m),G],number:"","input-class":"text-right",class:"fixedWidth"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:6},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:l(n).aligned?"mdi-check-circle":"mdi-alert-circle",color:l(n).aligned?"green":"red"},null,8,["name","color"])]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[22]||(o[22]=[r("Single Star Alignment",-1)])),_:1,__:[22]})]),_:1}),e(a,{side:""},{default:t(()=>[u("div",Ge,[l(n).aligning?(c(),p(R,{key:0,indeterminate:"",rounded:"",size:"sm"})):y("",!0),e(K,{label:"Skip",split:"",icon:"mdi-flare",onClick:o[10]||(o[10]=m=>ie(l(d).default_azimuth,l(d).default_altitude)),class:"fixedWidth"},{default:t(()=>[e(F,{dense:"",class:"q-mt-md q-mb-md"},{default:t(()=>[e(f,null,{default:t(()=>[e(a,null,{default:t(()=>[e(_,{caption:""},{default:t(()=>o[23]||(o[23]=[r("Use these defaults.",-1)])),_:1,__:[23]}),e(_,{caption:""},{default:t(()=>o[24]||(o[24]=[r("Plate solve later.",-1)])),_:1,__:[24]})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(P,{label:"Azimuth (deg:mm:ss)",modelValue:l(d).default_azimuth,"onUpdate:modelValue":[o[8]||(o[8]=m=>l(d).default_azimuth=m),G],"input-class":"text-right",class:"fixedWidth"},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(P,{label:"Altitude (deg:mm:ss)",modelValue:l(d).default_altitude,"onUpdate:modelValue":[o[9]||(o[9]=m=>l(d).default_altitude=m),_e],"input-class":"text-right",class:"fixedWidth"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:7},{default:t(()=>[e(a,{thumbnail:""},{default:t(()=>[e(g,{name:Q.value?"mdi-check-circle":"mdi-alert-circle",color:Q.value?"green":"red"},null,8,["name","color"])]),_:1}),e(a,null,{default:t(()=>[e(_,null,{default:t(()=>o[25]||(o[25]=[r("Multi Point Alignment",-1)])),_:1,__:[25]})]),_:1}),e(a,{side:""},{default:t(()=>[u("div",Je,[e(x,{label:"Align",split:"",icon:"mdi-creation-outline",to:"/sync",class:"fixedWidth"})])]),_:1})]),_:1})):y("",!0)]),_:1})])]),_:1})])):y("",!0)])]),_:1}))}});export{Qt as default};
