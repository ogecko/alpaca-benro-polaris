import{Q as ve}from"./QSpace-WNZS6s5s.js";import{Q as K}from"./QBtnDropdown-Bd8j8KW6.js";import{Q as J}from"./QCheckbox-D310Kbiw.js";import{Q as W}from"./QCircularProgress-DO6wLJZQ.js";import{Q as f,a as s}from"./QItem-CIxyHNF2.js";import{d as ee,q as te,B as G,E as p,F as t,J as u,K as y,I as e,Q as x,M as l,Y as A,R as g,N as r,H as c,c as k,z as be,w as Y,O as T,P as w,T as ye,S as Pe,Z as R}from"./index-CzUz1poz.js";import{Q as E}from"./QBadge-gmMlef8a.js";import{Q as _}from"./QItemLabel-4d6Diaq8.js";import{Q as P}from"./QInput-BuwOO0Om.js";import{Q as F}from"./QList-D1nyExqs.js";import{Q as j}from"./QCard-CK4i7p9g.js";import{Q as Z}from"./QSelect-DNfwVzCZ.js";import{Q as Ae}from"./QPage-2ewRn8KR.js";import{u as le}from"./use-quasar-vHExpJql.js";import{u as oe}from"./device-BWnNoMeK.js";import{u as ne}from"./config-Dv-6m4Q8.js";import{u as we,p as ke}from"./status-DQXUPgEb.js";import{d as L}from"./angles-BzRmwPyf.js";import{Q as C}from"./QToggle-5kUYLKJK.js";import{Q as X}from"./QBanner-gQDwPbxk.js";import"./QBtnGroup-CyVg6k59.js";import"./QMenu-CITyKRcB.js";import"./position-engine-kA1ZDrPo.js";import"./selection-BBj0YpLT.js";import"./focus-manager-BJWzFvJg.js";import"./use-model-toggle-Cl3EjlHt.js";import"./use-dark-CN-7xWWN.js";import"./use-tick-DJycfyCh.js";import"./use-timeout-DK6K2111.js";import"./use-key-composition-C77PqFJU.js";import"./use-checkbox-DA3H8di2.js";import"./format-BvkBI9bc.js";import"./QChip-Bahj5nA8.js";import"./use-prevent-scroll-aoiZHZdM.js";import"./rtl-DFPa-2ov.js";const he={class:"row"},Ce={class:"q-gutter-md flex justify-end q-mr-md"},xe={class:"col-auto q-gutter-sm flex justify-end items-center"},Se={class:"row q-col-gutter-sm no-wrap"},qe={class:"row q-col-gutter-sm no-wrap"},Ie={class:"row q-col-gutter-sm no-wrap"},Ve={class:"row q-col-gutter-sm no-wrap"},Qe={class:"row q-col-gutter-sm no-wrap"},Be={class:"row q-col-gutter-sm no-wrap"},Ue=ee({__name:"NetworkSettings",setup(ae){const S=le(),a=oe(),d=ne();te(async()=>{a.restAPIConnected&&a.restAPIConnectedAt&&d.fetchedAt<a.restAPIConnectedAt&&await d.configFetch()});function n(v,b,B){const U=d[v],h=typeof U,$=["string","number","boolean"].includes(h),H=h==="boolean";return{label:b,modelValue:$?U:"","onUpdate:modelValue":q=>{if(q!==null&&$){d[v]=q;const D={[v]:q};H?V(D):I(D)}}}}const I=G(v=>d.configUpdate(v),500),V=G(v=>d.configUpdate(v),5);async function Q(){const v=await d.configSave();S.notify({message:`Configuration save ${v?"successful":"unsucessful"}.`,type:v?"positive":"negative",position:"top",timeout:3e3,actions:[{icon:"mdi-close",color:"white"}]})}return(v,b)=>(c(),p(j,{flat:"",bordered:"",class:"q-pa-md"},{default:t(()=>[b[3]||(b[3]=u("div",{class:"text-h6"},"Alpaca Network Services",-1)),u("div",he,[b[0]||(b[0]=u("div",{class:"col text-caption text-grey-6 q-pb-md"}," The Alpaca Driver provides several network services for external aplications to use the Benro Polaris. Changes to Network Services require saving to take effect. ",-1)),u("div",Ce,[u("div",xe,[e(x,{rounded:"",color:"grey-9",label:"Save",onClick:Q,disable:l(d).isSaving,loading:l(d).isSaving},null,8,["disable","loading"])])])]),u("div",Se,[e(C,A({class:"col-8"},n("enable_restapi","Alpaca REST API Service")),null,16),e(P,A({class:"col-4"},n("alpaca_restapi_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_restapi?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),l(d).enable_restapi?y("",!0):(c(),p(X,{key:0,"inline-actions":"",rounded:"",class:"bg-warning"},{default:t(()=>b[1]||(b[1]=[r(" WARNING: The Alpaca REST API is required for Nina, Stellarium and Alpaca Pilot. ",-1)])),_:1,__:[1]})),l(d).alpaca_restapi_port!=l(a).restAPIPort?(c(),p(X,{key:1,"inline-actions":"",rounded:"",class:"bg-warning"},{default:t(()=>b[2]||(b[2]=[r(" WARNING: The Alpaca REST API port will change. Please reconnect Alpaca Pilot when prompted. ",-1)])),_:1,__:[2]})):y("",!0),u("div",qe,[e(C,A({class:"col-8"},n("enable_discovery","Alpaca Discovery Service")),null,16),e(P,A({class:"col-4"},n("alpaca_discovery_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_discovery?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Ie,[e(C,A({class:"col-8"},n("enable_pilot","Alpaca Pilot Webserver")),null,16),e(P,A({class:"col-4"},n("alpaca_pilot_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_pilot?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Ve,[e(C,A({class:"col-8"},n("enable_socket","Alpaca Pilot Socket IO")),null,16),e(P,A({class:"col-4"},n("alpaca_socket_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_socket?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Qe,[e(C,A({class:"col-8"},n("enable_synscan","SynSCAN API Service")),null,16),e(P,A({class:"col-4"},n("stellarium_synscan_port","Port"),{type:"number","input-class":"text-right",style:{visibility:l(d).enable_synscan?"visible":"hidden"}}),{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},16,["style"])]),u("div",Be,[e(C,A({class:"col-8"},n("polaris_auto_retry","Auto Retry Polaris Connection")),null,16)])]),_:1,__:[3]}))}}),$e={class:"row q-pb-sm q-col-gutter-md items-center"},De={class:"col text-h6 q-ml-md"},Ne={key:0,class:"text-caption text-grey-6"},ze={class:"q-gutter-md flex justify-end q-mr-md"},Me={class:"row q-col-gutter-sm items-stretch"},We={class:"col-12 col-md-6 flex"},Te={class:"text-h6"},Re={class:"q-gutter-sm q-pl-sm"},Ee={class:"row items-start"},Fe={key:0,class:"col-12 col-md-6 flex"},He={class:"text-h6"},Ke={class:"q-mt-md q-pl-lg"},Le={class:"q-gutter-sm q-pl-sm"},Ge={key:2},je={class:"row items-start"},Oe={class:"row items-center q-gutter-sm"},Je={class:"row items-center q-gutter-sm"},Bt=ee({__name:"ConnectPage",setup(ae){const S=le(),a=oe(),d=ne(),n=we(),I=k({get:()=>a.alpacaHost,set:i=>a.setAlpacaHost(i)}),V=k({get:()=>a.restAPIPort,set:i=>a.setRestAPIPort(Number(i))}),Q=k(()=>n.aligned_count>=3),v=k(()=>n.bledevices.length),b=k(()=>!!n.bleselected&&v.value>0),B=k(()=>!!n.connected),U=k(()=>v.value==0?"Check Power or Bluetooth, no devices discovered.":v.value>1?"Multiple devices discovered.":b.value?"":"Please select device."),h=k(()=>n.polarismode==8),$=k(()=>h.value?"":"Change Polaris Mode to Astro.");te(async()=>{}),be(()=>{});async function H(i){await a.bleSelectDevice(i)}async function q(){await a.bleEnableWifi()}async function D(){console.log("Goto Park Position"),await a.alpacaPark(),await a.alpacaUnPark()}async function se(i="180.0"){const o=L(i,"deg");console.log("Set Compass Alignment to ${bearing}"),await a.setPolarisCompass(o)}async function ie(i="180.0",o="45.0"){const m=L(i,"deg"),ge=L(o,"deg");console.log("Set Alignment Alignment Az ${az}, Alt ${alt}"),await a.setPolarisAlignment(m,ge)}async function de(i){console.log("Polaris Mode",i),n.polarismode=i,await a.setPolarisMode(i)}async function re(i){i&&!a.restAPIConnected?await N():!i&&a.restAPIConnected&&ue()}Y(()=>a.restAPIConnected,async i=>{i&&(await d.configFetch(),S.notify({message:"Alpaca Driver successfuly connected.",type:"positive",position:"top",timeout:3e3,actions:[{icon:"mdi-close",color:"white"}]}))});async function N(){a.restAPIConnected||await a.connectRestAPI()}function ue(){a.restAPIConnected&&a.disconnectRestAPI()}async function ce(i){i&&!n.connected?await z():!i&&n.connected&&await me()}Y(()=>n.connected,i=>{i&&S.notify({message:"Benro Polaris successfuly connected.",type:"positive",position:"top",timeout:3e3,actions:[{icon:"mdi-close",color:"white"}]})});async function z(){console.log("Connecting to Polaris"),n.connected||await a.connectPolaris()}async function me(){console.log("Disconnect Polaris"),n.connected&&await a.disconnectPolaris()}function pe(i){M({polaris_ip_address:i})}function fe(i){M({polaris_port:i})}function O(i){M({default_azimuth:i})}function _e(i){M({default_altitude:i})}const M=G(i=>d.configUpdate(i),500);return(i,o)=>(c(),p(Ae,{class:"q-pa-sm"},{default:t(()=>[u("div",$e,[u("div",De,[o[11]||(o[11]=r(" Device Connections ",-1)),l(S).screen.gt.xs?(c(),T("div",Ne," Connect to the Alpaca Driver and Benro Polaris. ")):y("",!0)]),e(ve),u("div",ze,[e(K,{rounded:"",color:"grey-9",label:"Network Services","content-style":{width:"600px"}},{default:t(()=>[e(Ue)]),_:1})])]),u("div",Me,[u("div",We,[e(j,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:t(()=>[u("div",Te,[e(J,{label:"Connect to Alpaca Driver",color:"positive","model-value":l(a).restAPIConnected,"onUpdate:modelValue":re},null,8,["model-value"])]),e(F,{class:"q-pl-lg"},{default:t(()=>[l(a).restAPIConnectingMsg?(c(),p(f,{key:0},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(W,{indeterminate:"",rounded:"",size:"lg",color:"positive"})]),_:1}),e(s,null,{default:t(()=>[r(w(l(a).restAPIConnectingMsg),1)]),_:1})]),_:1})):l(a).restAPIConnected?(c(),p(f,{key:1},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-check-circle",color:"green"})]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>[r(w(l(a).alpacaServerName)+" ",1),u("span",Re,[e(E,null,{default:t(()=>[r("v"+w(l(a).alpacaServerVersion),1)]),_:1}),(c(!0),T(Pe,null,ye(l(a).alpacaDevices,m=>(c(),p(E,{key:m,color:"positive"},{default:t(()=>[r(w(m),1)]),_:2},1024))),128))])]),_:1})]),_:1})]),_:1})):(c(),p(f,{key:2},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-alert-circle",color:"red"})]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[12]||(o[12]=[r("Alpaca Driver Connection Problem",-1)])),_:1,__:[12]}),e(_,{caption:""},{default:t(()=>[r(w(l(a).restAPIConnectErrorMsg),1)]),_:1})]),_:1}),l(a).restAPIConnected?y("",!0):(c(),p(s,{key:0,side:""},{default:t(()=>[e(x,{label:"Connect",icon:"mdi-wifi",onClick:N,class:"fixedWidth"})]),_:1}))]),_:1})),!l(a).restAPIConnected&&!l(a).restAPIConnectingMsg?(c(),p(f,{key:3,"inset-level":.5},{default:t(()=>[e(s,null,{default:t(()=>[u("div",Ee,[e(P,{class:"col-8",modelValue:I.value,"onUpdate:modelValue":o[0]||(o[0]=m=>I.value=m),onKeyup:R(N,["enter"]),label:"Host Name / IP Address"},null,8,["modelValue"]),e(P,{class:"col-4",label:"Port",modelValue:V.value,"onUpdate:modelValue":o[1]||(o[1]=m=>V.value=m),onKeyup:R(N,["enter"]),type:"number","input-class":"text-right"},{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})]),l(a).restAPIConnected?(c(),T("div",Fe,[e(j,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:t(()=>[u("div",He,[e(J,{"model-value":l(n).connected,"onUpdate:modelValue":ce,color:"positive",label:"Connect Driver to Benro Polaris"},null,8,["model-value"])]),u("div",Ke,[e(F,null,{default:t(()=>[e(f,null,{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:b.value?"mdi-check-circle":"mdi-alert-circle",color:b.value?"green":"red"},null,8,["name","color"])]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[13]||(o[13]=[r("Select Benro Polaris",-1)])),_:1,__:[13]}),e(_,{caption:""},{default:t(()=>[r(w(U.value),1)]),_:1})]),_:1}),v.value>0?(c(),p(s,{key:0,side:""},{default:t(()=>[e(Z,{label:"Device",modelValue:l(n).bleselected,"onUpdate:modelValue":[o[2]||(o[2]=m=>l(n).bleselected=m),H],options:l(n).bledevices,dense:"","options-dense":"","display-value":`${b.value?l(n).bleselected:"Unselected"}`,color:"secondary"},{before:t(()=>[l(n).bleisenablingwifi?(c(),p(W,{key:0,indeterminate:"",rounded:"",size:"sm",color:"primary"})):(c(),p(x,{key:1,round:"",dense:"",flat:"",icon:"mdi-wifi-sync",color:l(n).bleiswifienabled?"primary":"white",onClick:q},null,8,["color"]))]),_:1},8,["modelValue","options","display-value"])]),_:1})):y("",!0)]),_:1}),l(n).connecting&&l(n).bleselected?(c(),p(f,{key:0},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(W,{indeterminate:"",rounded:"",size:"lg",color:"positive"})]),_:1}),e(s,null,{default:t(()=>o[14]||(o[14]=[r("Connecting...",-1)])),_:1,__:[14]})]),_:1})):B.value?(c(),p(f,{key:1},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-check-circle",color:"green"})]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>[o[15]||(o[15]=r(" Benro Polaris ",-1)),u("span",Le,[e(E,null,{default:t(()=>[r("hw v"+w(l(n).polarishwver),1)]),_:1}),e(E,null,{default:t(()=>[r("sw v"+w(l(n).polarisswver),1)]),_:1})])]),_:1,__:[15]})]),_:1})]),_:1})):b.value?(c(),T("div",Ge,[e(f,null,{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:"mdi-alert-circle",color:"red"})]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[16]||(o[16]=[r("Benro Polaris Connection Problem",-1)])),_:1,__:[16]}),e(_,{caption:""},{default:t(()=>[r(w(l(n).connectionmsg),1)]),_:1})]),_:1}),e(s,{side:""},{default:t(()=>[e(x,{label:"Connect",icon:"mdi-wifi",onClick:z,class:"fixedWidth"})]),_:1})]),_:1}),e(f,{"inset-level":.5},{default:t(()=>[e(s,null,{default:t(()=>[u("div",je,[e(P,{class:"col-8 q-pt-none",label:"Host Name / IP Address",modelValue:l(d).polaris_ip_address,"onUpdate:modelValue":[o[3]||(o[3]=m=>l(d).polaris_ip_address=m),pe],onKeyup:R(z,["enter"])},null,8,["modelValue"]),e(P,{class:"col-4",label:"Port",type:"number","input-class":"text-right",modelValue:l(d).polaris_port,"onUpdate:modelValue":[o[4]||(o[4]=m=>l(d).polaris_port=m),fe],onKeyup:R(z,["enter"])},{prepend:t(()=>[e(g,{name:"mdi-network-outline"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})])):y("",!0),l(n).connected?(c(),p(f,{key:3},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:h.value?"mdi-check-circle":"mdi-alert-circle",color:h.value?"green":"red"},null,8,["name","color"])]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[17]||(o[17]=[r("Select Astro Mode",-1)])),_:1,__:[17]}),e(_,{caption:""},{default:t(()=>[r(w($.value),1)]),_:1})]),_:1}),e(s,{side:""},{default:t(()=>[e(Z,{label:"Mode",modelValue:l(n).polarismode,"onUpdate:modelValue":[o[5]||(o[5]=m=>l(n).polarismode=m),de],options:l(ke),"display-value":`${l(n).polarismodestr}`,"emit-value":"","map-options":"",dense:"","options-dense":"",class:"fixedWidth",color:"secondary"},{default:t(()=>[u("template",null,[e(g,{name:"mdi-satellite-variant"})])]),_:1},8,["modelValue","options","display-value"])]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:4},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:B.value?"mdi-check-circle":"mdi-alert-circle",color:B.value?"green":"red"},null,8,["name","color"])]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[18]||(o[18]=[r("Goto Park Position",-1)])),_:1,__:[18]})]),_:1}),e(s,{side:""},{default:t(()=>[e(x,{label:"Park",icon:"mdi-parking",class:"fixedWidth",onClick:D})]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:5},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:l(n).compassed?"mdi-check-circle":"mdi-alert-circle",color:l(n).compassed?"green":"red"},null,8,["name","color"])]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[19]||(o[19]=[r("Compass Alignment",-1)])),_:1,__:[19]})]),_:1}),e(s,{side:""},{default:t(()=>[e(K,{label:"Skip",split:"",icon:"mdi-compass",onClick:o[7]||(o[7]=m=>se(l(d).default_azimuth)),class:"fixedWidth"},{default:t(()=>[e(F,{dense:"",class:"q-mt-md q-mb-md"},{default:t(()=>[e(f,null,{default:t(()=>[e(s,null,{default:t(()=>[e(_,{caption:""},{default:t(()=>o[20]||(o[20]=[r("Use this default.",-1)])),_:1,__:[20]}),e(_,{caption:""},{default:t(()=>o[21]||(o[21]=[r("Plate solve later.",-1)])),_:1,__:[21]})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(P,{label:"Azimuth (deg:mm:ss)",modelValue:l(d).default_azimuth,"onUpdate:modelValue":[o[6]||(o[6]=m=>l(d).default_azimuth=m),O],number:"","input-class":"text-right",class:"fixedWidth"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:6},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:l(n).aligned?"mdi-check-circle":"mdi-alert-circle",color:l(n).aligned?"green":"red"},null,8,["name","color"])]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[22]||(o[22]=[r("Single Star Alignment",-1)])),_:1,__:[22]})]),_:1}),e(s,{side:""},{default:t(()=>[u("div",Oe,[l(n).aligning?(c(),p(W,{key:0,indeterminate:"",rounded:"",size:"sm"})):y("",!0),e(K,{label:"Skip",split:"",icon:"mdi-flare",onClick:o[10]||(o[10]=m=>ie(l(d).default_azimuth,l(d).default_altitude)),class:"fixedWidth"},{default:t(()=>[e(F,{dense:"",class:"q-mt-md q-mb-md"},{default:t(()=>[e(f,null,{default:t(()=>[e(s,null,{default:t(()=>[e(_,{caption:""},{default:t(()=>o[23]||(o[23]=[r("Use these defaults.",-1)])),_:1,__:[23]}),e(_,{caption:""},{default:t(()=>o[24]||(o[24]=[r("Plate solve later.",-1)])),_:1,__:[24]})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(P,{label:"Azimuth (deg:mm:ss)",modelValue:l(d).default_azimuth,"onUpdate:modelValue":[o[8]||(o[8]=m=>l(d).default_azimuth=m),O],"input-class":"text-right",class:"fixedWidth"},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(P,{label:"Altitude (deg:mm:ss)",modelValue:l(d).default_altitude,"onUpdate:modelValue":[o[9]||(o[9]=m=>l(d).default_altitude=m),_e],"input-class":"text-right",class:"fixedWidth"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})):y("",!0),l(n).connected?(c(),p(f,{key:7},{default:t(()=>[e(s,{thumbnail:""},{default:t(()=>[e(g,{name:Q.value?"mdi-check-circle":"mdi-alert-circle",color:Q.value?"green":"red"},null,8,["name","color"])]),_:1}),e(s,null,{default:t(()=>[e(_,null,{default:t(()=>o[25]||(o[25]=[r("Multi Point Alignment",-1)])),_:1,__:[25]})]),_:1}),e(s,{side:""},{default:t(()=>[u("div",Je,[e(x,{label:"Align",split:"",icon:"mdi-creation-outline",to:"/sync",class:"fixedWidth"})])]),_:1})]),_:1})):y("",!0)]),_:1})])]),_:1})])):y("",!0)])]),_:1}))}});export{Bt as default};
