import{u as le,a as ae}from"./use-dark-DUyNUrlH.js";import{e as B,h as f,s as F,a4 as re,w as H,i as X,q as oe,m as Y,a5 as ie,a as s,c as i,B as ne,a6 as ue,a7 as ce,A as se}from"./index-CabLL4je.js";import{Q as R}from"./stream-BVJeLFz-.js";import{s as ve,c as fe,d as he,e as be,f as I,h as k}from"./use-model-toggle-D0RNB08i.js";import{T as L}from"./TouchPan-BdM62U__.js";import{b as T}from"./format-BvkBI9bc.js";const de=B({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(e){return()=>[f("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),f("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),F(f("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),F(f("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]}}),{passive:N}=re,me=["both","horizontal","vertical"],ze=B({name:"QScrollObserver",props:{axis:{type:String,validator:e=>me.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:ve},emits:["scroll"],setup(e,{emit:A}){const n={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let h=null,u,m;H(()=>e.scrollTarget,()=>{b(),t()});function r(){h?.();const z=Math.max(0,he(u)),c=be(u),v={top:z-n.position.top,left:c-n.position.left};if(e.axis==="vertical"&&v.top===0||e.axis==="horizontal"&&v.left===0)return;const _=Math.abs(v.top)>=Math.abs(v.left)?v.top<0?"up":"down":v.left<0?"left":"right";n.position={top:z,left:c},n.directionChanged=n.direction!==_,n.delta=v,n.directionChanged===!0&&(n.direction=_,n.inflectionPoint=n.position),A("scroll",{...n})}function t(){u=fe(m,e.scrollTarget),u.addEventListener("scroll",g,N),g(!0)}function b(){u!==void 0&&(u.removeEventListener("scroll",g,N),u=void 0)}function g(z){if(z===!0||e.debounce===0||e.debounce==="0")r();else if(h===null){const[c,v]=e.debounce?[setTimeout(r,e.debounce),clearTimeout]:[requestAnimationFrame(r),cancelAnimationFrame];h=()=>{v(c),h=null}}}const{proxy:d}=X();return H(()=>d.$q.lang.rtl,r),oe(()=>{m=d.$el.parentNode,t()}),Y(()=>{h?.(),b()}),Object.assign(d,{trigger:g,getPosition:()=>n}),ie}}),p=["vertical","horizontal"],w={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},x={prevent:!0,mouse:!0,mouseAllDir:!0},U=e=>e>=250?50:Math.ceil(e/5),qe=B({name:"QScrollArea",props:{...le,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:A,emit:n}){const h=s(!1),u=s(!1),m=s(!1),r={vertical:s(0),horizontal:s(0)},t={vertical:{ref:s(null),position:s(0),size:s(0)},horizontal:{ref:s(null),position:s(0),size:s(0)}},{proxy:b}=X(),g=ae(e,b.$q);let d=null,z;const c=s(null),v=i(()=>"q-scrollarea"+(g.value===!0?" q-scrollarea--dark":""));Object.assign(r,{verticalInner:i(()=>r.vertical.value-e.verticalOffset[0]-e.verticalOffset[1]),horizontalInner:i(()=>r.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1])}),t.vertical.percentage=i(()=>{const l=t.vertical.size.value-r.vertical.value;if(l<=0)return 0;const a=T(t.vertical.position.value/l,0,1);return Math.round(a*1e4)/1e4}),t.vertical.thumbHidden=i(()=>(e.visible===null?m.value:e.visible)!==!0&&h.value===!1&&u.value===!1||t.vertical.size.value<=r.vertical.value+1),t.vertical.thumbStart=i(()=>e.verticalOffset[0]+t.vertical.percentage.value*(r.verticalInner.value-t.vertical.thumbSize.value)),t.vertical.thumbSize=i(()=>Math.round(T(r.verticalInner.value*r.verticalInner.value/t.vertical.size.value,U(r.verticalInner.value),r.verticalInner.value))),t.vertical.style=i(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${t.vertical.thumbStart.value}px`,height:`${t.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`})),t.vertical.thumbClass=i(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(t.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),t.vertical.barClass=i(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(t.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),t.horizontal.percentage=i(()=>{const l=t.horizontal.size.value-r.horizontal.value;if(l<=0)return 0;const a=T(Math.abs(t.horizontal.position.value)/l,0,1);return Math.round(a*1e4)/1e4}),t.horizontal.thumbHidden=i(()=>(e.visible===null?m.value:e.visible)!==!0&&h.value===!1&&u.value===!1||t.horizontal.size.value<=r.horizontal.value+1),t.horizontal.thumbStart=i(()=>e.horizontalOffset[0]+t.horizontal.percentage.value*(r.horizontalInner.value-t.horizontal.thumbSize.value)),t.horizontal.thumbSize=i(()=>Math.round(T(r.horizontalInner.value*r.horizontalInner.value/t.horizontal.size.value,U(r.horizontalInner.value),r.horizontalInner.value))),t.horizontal.style=i(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[b.$q.lang.rtl===!0?"right":"left"]:`${t.horizontal.thumbStart.value}px`,width:`${t.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`})),t.horizontal.thumbClass=i(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(t.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),t.horizontal.barClass=i(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(t.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const _=i(()=>t.vertical.thumbHidden.value===!0&&t.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle);function $(){const l={};return p.forEach(a=>{const o=t[a];Object.assign(l,{[a+"Position"]:o.position.value,[a+"Percentage"]:o.percentage.value,[a+"Size"]:o.size.value,[a+"ContainerSize"]:r[a].value,[a+"ContainerInnerSize"]:r[a+"Inner"].value})}),l}const j=ne(()=>{const l=$();l.ref=b,n("scroll",l)},0);function D(l,a,o){if(p.includes(l)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(l==="vertical"?k:I)(c.value,a,o)}function G({height:l,width:a}){let o=!1;r.vertical.value!==l&&(r.vertical.value=l,o=!0),r.horizontal.value!==a&&(r.horizontal.value=a,o=!0),o===!0&&q()}function J({position:l}){let a=!1;t.vertical.position.value!==l.top&&(t.vertical.position.value=l.top,a=!0),t.horizontal.position.value!==l.left&&(t.horizontal.position.value=l.left,a=!0),a===!0&&q()}function K({height:l,width:a}){t.horizontal.size.value!==a&&(t.horizontal.size.value=a,q()),t.vertical.size.value!==l&&(t.vertical.size.value=l,q())}function E(l,a){const o=t[a];if(l.isFirst===!0){if(o.thumbHidden.value===!0)return;z=o.position.value,u.value=!0}else if(u.value!==!0)return;l.isFinal===!0&&(u.value=!1);const y=w[a],O=(o.size.value-r[a].value)/(r[a+"Inner"].value-o.thumbSize.value),P=l.distance[y.dist],C=z+(l.direction===y.dir?1:-1)*P*O;V(C,a)}function Q(l,a){const o=t[a];if(o.thumbHidden.value!==!0){const y=a==="vertical"?e.verticalOffset[0]:e.horizontalOffset[0],O=l[w[a].offset]-y,P=o.thumbStart.value-y;if(O<P||O>P+o.thumbSize.value){const C=O-o.thumbSize.value/2,te=T(C/(r[a+"Inner"].value-o.thumbSize.value),0,1);V(te*Math.max(0,o.size.value-r[a].value),a)}o.ref.value!==null&&o.ref.value.dispatchEvent(new MouseEvent(l.type,l))}}function q(){h.value=!0,d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,h.value=!1},e.delay),e.onScroll!==void 0&&j()}function V(l,a){c.value[w[a].scroll]=l}let S=null;function W(){S!==null&&clearTimeout(S),S=setTimeout(()=>{S=null,m.value=!0},b.$q.platform.is.ios?50:0)}function Z(){S!==null&&(clearTimeout(S),S=null),m.value=!1}let M=null;H(()=>b.$q.lang.rtl,l=>{c.value!==null&&I(c.value,Math.abs(t.horizontal.position.value)*(l===!0?-1:1))}),ue(()=>{M={top:t.vertical.position.value,left:t.horizontal.position.value}}),ce(()=>{if(M===null)return;const l=c.value;l!==null&&(I(l,M.left),k(l,M.top))}),Y(j.cancel),Object.assign(b,{getScrollTarget:()=>c.value,getScroll:$,getScrollPosition:()=>({top:t.vertical.position.value,left:t.horizontal.position.value}),getScrollPercentage:()=>({top:t.vertical.percentage.value,left:t.horizontal.percentage.value}),setScrollPosition:D,setScrollPercentage(l,a,o){D(l,a*(t[l].size.value-r[l].value)*(l==="horizontal"&&b.$q.lang.rtl===!0?-1:1),o)}});const ee={scroll:t,thumbVertDir:[[L,l=>{E(l,"vertical")},void 0,{vertical:!0,...x}]],thumbHorizDir:[[L,l=>{E(l,"horizontal")},void 0,{horizontal:!0,...x}]],onVerticalMousedown(l){Q(l,"vertical")},onHorizontalMousedown(l){Q(l,"horizontal")}};return()=>f("div",{class:v.value,onMouseenter:W,onMouseleave:Z},[f("div",{ref:c,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[f("div",{class:"q-scrollarea__content absolute",style:_.value},se(A.default,[f(R,{debounce:0,onResize:K})])),f(ze,{axis:"both",onScroll:J})]),f(R,{debounce:0,onResize:G}),f(de,{store:ee,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}});export{ze as Q,qe as a};
