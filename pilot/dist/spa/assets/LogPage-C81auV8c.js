import{Q as T}from"./QBadge-By89G4mp.js";import{Q as z}from"./QSpace-BN0aJBPV.js";import{Q as U}from"./QBtnDropdown-C0BUcS7H.js";import{Q as d}from"./QToggle-Bw93hT-T.js";import{Q as G}from"./QResizeObserver-BsESWmlU.js";import{a0 as M,a1 as W,e as H,a as _,y as w,c as P,h as B,W as j,t as J,f as K,d as k,q as O,B as X,E as I,F as b,J as r,I as s,X as u,H as h,z as Y,w as Q,M as D,L as N,O as C,a2 as Z,T as oo,S as eo,P as to}from"./index-D0PfnkpG.js";import{a as so}from"./QScrollArea-13ljehki.js";import{Q as $}from"./QCard-6DoyIm7v.js";import{Q as no}from"./QPage-DDnpSOm6.js";import{u as lo}from"./stream-BL2iVR09.js";import{Q as io}from"./QSelect-Jbwy6a8_.js";import{u as ro}from"./config-DgLwdXr6.js";import{u as x}from"./device-BmVq6k0z.js";import{_ as ao}from"./StatusBanners.vue_vue_type_script_setup_true_lang-BRv7l7Yp.js";import"./QBtnGroup-BfIGs6_K.js";import"./QMenu-CIx404Kj.js";import"./position-engine-DcXdba3W.js";import"./selection-B4v7s9oW.js";import"./focus-manager-BJWzFvJg.js";import"./use-model-toggle-R2LY4fXv.js";import"./use-dark-8KyFGCrv.js";import"./use-tick-BSz4V3MX.js";import"./use-timeout-el27kvYe.js";import"./use-key-composition-Di3_QzSz.js";import"./use-checkbox-Bv6dtl4F.js";import"./QItem-DWSf3WsE.js";import"./TouchPan-BHNRWIr1.js";import"./touch-BjYP5sR0.js";import"./format-BvkBI9bc.js";import"./status-BAlaugUt.js";import"./QChip-C2ElM3rU.js";import"./QItemLabel-DtikKCSR.js";import"./use-prevent-scroll-DLCZIoYY.js";import"./rtl-DFPa-2ov.js";import"./QBanner-Dj-BV9YE.js";const V={threshold:0,root:null,rootMargin:"0px"};function R(e,o,n){let t,c,l;typeof n=="function"?(t=n,c=V,l=o.cfg===void 0):(t=n.handler,c=Object.assign({},V,n.cfg),l=o.cfg===void 0||W(o.cfg,c)===!1),o.handler!==t&&(o.handler=t),l===!0&&(o.cfg=c,o.observer?.unobserve(e),o.observer=new IntersectionObserver(([a])=>{if(typeof o.handler=="function"){if(a.rootBounds===null&&document.body.contains(e)===!0){o.observer.unobserve(e),o.observer.observe(e);return}(o.handler(a,o.observer)===!1||o.once===!0&&a.isIntersecting===!0)&&E(e)}},c),o.observer.observe(e))}function E(e){const o=e.__qvisible;o!==void 0&&(o.observer?.unobserve(e),delete e.__qvisible)}const co=M({name:"intersection",mounted(e,{modifiers:o,value:n}){const t={once:o.once===!0};R(e,t,n),e.__qvisible=t},updated(e,o){const n=e.__qvisible;n!==void 0&&R(e,n,o.value)},beforeUnmount:E}),uo=H({name:"QIntersection",props:{tag:{type:String,default:"div"},once:Boolean,transition:String,transitionDuration:{type:[String,Number],default:300},ssrPrerender:Boolean,margin:String,threshold:[Number,Array],root:{default:null},disable:Boolean,onVisibility:Function},setup(e,{slots:o,emit:n}){const t=_(w.value===!0?e.ssrPrerender:!1),c=P(()=>e.root!==void 0||e.margin!==void 0||e.threshold!==void 0?{handler:v,cfg:{root:e.root,rootMargin:e.margin,threshold:e.threshold}}:v),l=P(()=>e.disable!==!0&&(w.value!==!0||e.once!==!0||e.ssrPrerender!==!0)),a=P(()=>[[co,c.value,void 0,{once:e.once}]]),f=P(()=>`--q-transition-duration: ${e.transitionDuration}ms`);function v(g){t.value!==g.isIntersecting&&(t.value=g.isIntersecting,e.onVisibility!==void 0&&n("visibility",t.value))}function p(){if(t.value===!0)return[B("div",{key:"content",style:f.value},K(o.default))];if(o.hidden!==void 0)return[B("div",{key:"hidden",style:f.value},o.hidden())]}return()=>{const g=e.transition?[B(j,{name:"q-transition--"+e.transition},p)]:p();return J(e.tag,{class:"q-intersection"},g,"main",l.value,()=>a.value)}}}),mo={class:"row q-mb-md"},go={class:"q-gutter-y-sm"},fo={class:"row"},vo={class:"row"},po={class:"row"},_o={class:"row"},bo={class:"row"},ho={class:"row"},yo=k({__name:"LogSettings",setup(e){const o=x(),n=ro();O(async()=>{o.restAPIConnected&&o.restAPIConnectedAt&&n.fetchedAt<o.restAPIConnectedAt&&await n.configFetch()});function t(l,a,f){const v=n[l],p=typeof v,g=["string","number","boolean"].includes(p);return{label:a,modelValue:g?v:"","onUpdate:modelValue":y=>{if(y!==null&&g){n[l]=y;const S={[l]:y};c(S)}}}}const c=X(l=>n.configUpdate(l),5);return(l,a)=>(h(),I($,{flat:"",bordered:"",class:"q-pa-md"},{default:b(()=>[a[0]||(a[0]=r("div",{class:"text-h6"},"Protocol Log Settings",-1)),a[1]||(a[1]=r("div",{class:"row"},[r("div",{class:"col-12 text-caption text-grey-6 q-pb-md"}," Select which messages to log, such as those from Alpaca clients (NINA, CCDciel, Pilot), SynScan apps (Stellarium), and the messages sent to the Benro Polaris. ")],-1)),r("div",mo,[s(io,u({class:"col-12 q-pb-md",filled:""},t("log_level","Log Detail and Verbosity Level"),{options:[{label:"DEBUG – Detailed diagnostic logs",value:"DEBUG"},{label:"INFO – Default routine logging information",value:"INFO"},{label:"WARNING – Only log unexpected issues and above",value:"WARNING"},{label:"ERROR – Only log serious functional problems",value:"ERROR"},{label:"CRITICAL – Only log fatal system errors",value:"CRITICAL"}],"emit-value":"","map-options":""}),null,16)]),r("div",go,[r("div",fo,[s(d,u({class:"col-6"},t("log_alpaca_protocol","Log Alpaca Protocol")),null,16),s(d,u({class:"col-6"},t("log_alpaca_polling","Log Alpaca Polling")),null,16)]),r("div",vo,[s(d,u({class:"col-6"},t("log_alpaca_discovery","Log Alpaca Discovery")),null,16),s(d,u({class:"col-6"},t("log_alpaca_actions","Log Action Invokation")),null,16)]),r("div",po,[s(d,u({class:"col-6"},t("log_rotator_protocol","Log Rotator Protocol")),null,16),s(d,u({class:"col-6"},t("log_pulse_guiding","Log Pulse Guiding")),null,16)]),r("div",_o,[s(d,u({class:"col-6"},t("log_synscan_protocol","Log SynSCAN Protocol")),null,16),s(d,u({class:"col-6"},t("log_synscan_polling","Log SynSCAN Polling")),null,16)]),r("div",bo,[s(d,u({class:"col-6"},t("log_polaris_protocol","Log Benro Polaris Protocol")),null,16),s(d,u({class:"col-6"},t("log_polaris_polling","Log Benro Polaris Polling")),null,16)]),r("div",ho,[s(d,u({class:"col-6"},t("log_polaris_ble","Log Bluetooth Low Energy")),null,16)])])]),_:1,__:[0,1]}))}}),So={class:"row q-pb-sm q-col-gutter-md items-center"},Ao={class:"col text-h6 q-ml-md"},Po={key:1,class:"text-caption text-grey-6"},Lo={class:"q-gutter-md flex justify-end q-mr-md"},ie=k({__name:"LogPage",setup(e){const o=lo(),n=x(),t=P(()=>o.topics.log||[]),c=_(!0),l=_(!0),a=_(),f=_(),v=_(0);O(()=>{o.connectSocket(),o.subscribe("log"),S()}),Y(()=>{o.unsubscribe("log")}),Q(()=>n.isVisible,i=>{i?o.subscribe("log"):o.unsubscribe("log")});function p(i){console.log("Resize Log",i),v.value=i.height-50}function g(i){const m=i.ts||"",A=i.level||"",q="text"in i.data?i.data.text:JSON.stringify(i.data);return`[${m}] [${A}] ${q}`}function y(i){c.value=i}function S(){const i=f.value.getScroll(),m=i.verticalSize-i.verticalContainerSize;f.value.setScrollPosition("vertical",m,200)}function L(){l.value=!1}function F(){l.value&&S()}return Q(l,i=>{i&&S()}),(i,m)=>(h(),I(no,{class:"q-pa-sm column"},{default:b(()=>[s(ao),r("div",So,[r("div",Ao,[m[2]||(m[2]=D(" Alpaca Driver Log ",-1)),c.value?(h(),I(T,{key:0,size:"lg",color:"primary"},{default:b(()=>m[1]||(m[1]=[D("Live",-1)])),_:1,__:[1]})):N("",!0),i.$q.screen.gt.xs?(h(),C("div",Po," Monitor device status, activity, communications, and events in real time ")):N("",!0)]),s(z),r("div",Lo,[s(U,{rounded:"",color:"grey-9",label:"Log Settings","content-style":{width:"600px"}},{default:b(()=>[s(yo)]),_:1}),s(d,{dense:"",label:"Live",modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=A=>l.value=A)},null,8,["modelValue"])])]),s($,{ref_key:"cardArea",ref:a,flat:"",bordered:"",class:"col full-height q-pa-md text-body1",style:{"font-family":"monospace"}},{default:b(()=>[s(G,{onResize:p}),s(so,{ref_key:"scrollArea",ref:f,onScroll:F,style:Z({height:v.value+"px"}),onWheel:L,onClick:L,onTouchstart:L},{default:b(()=>[r("div",null,[(h(!0),C(eo,null,oo(t.value,(A,q)=>(h(),C("div",{key:q},to(g(A)),1))),128)),s(uo,{onVisibility:y})])]),_:1},8,["style"])]),_:1},512)]),_:1}))}});export{ie as default};
