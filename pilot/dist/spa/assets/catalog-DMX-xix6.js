import{a as M,P as v}from"./device-_czZEvqZ.js";import{aC as z,au as x}from"./index-T-4rhSG0.js";import{u as P}from"./status-8gs9HN__.js";import{u as L}from"./config-D59Dsqa0.js";import{t as l,h as d,e as O,g as N}from"./angles-gRV9FYwb.js";const c=P(),h=L();let n=null;const G=[{field:"Rt",direction:"desc"},{field:"Sz",direction:"desc"},{field:"Name",direction:"asc"}],I=z("catalog",{state:()=>({dsos:[],dsoGotoed:void 0,page:1,pageSize:10,selected:0,searchFor:"",filter:{Rt:void 0,Sz:void 0,Vz:void 0,Cn:void 0,C1:void 0,C2:void 0,Az:void 0,Alt:void 0},sorting:[]}),getters:{site_sidereal:()=>c.siderealtime,site_lat:()=>h.site_latitude,site_lon:()=>h.site_longitude,cur_azimuth:()=>c.azimuth,cur_altitude:()=>c.altitude,isVisible(){return v.appVisible},filtered(){const t=g(this.searchFor);return this.dsos.filter(e=>{const r=Object.entries(this.filter).every(([a,s])=>{const o=e[a];return a==="Alt"?(s==null||Array.isArray(s)&&s.length===0?t==""?[1,2,3,4,5]:[0,1,2,3,4,5,6]:s).includes(o):s==null||Array.isArray(s)&&s.length===0?!0:Array.isArray(s)?o!=null&&s.includes(o):o===s}),i=t===""||(e.SearchText?.includes(t)??!1);return r&&i})},isFiltered(){return Object.values(this.filter).some(t=>t==null?!1:Array.isArray(t)?t.length>0:!0)},sorted(){return[...this.filtered].sort((t,e)=>{const r=this.sorting.length>0?this.sorting:G;for(const{field:i,direction:a}of r){const s=t[i],o=e[i];if(!(s==null&&o==null)){if(s==null)return 1;if(o==null)return-1;if(s>o)return a==="asc"?1:-1;if(s<o)return a==="asc"?-1:1}}return 0})},paginated(){const t=(this.page-1)*this.pageSize;return this.sorted.slice(t,t+this.pageSize)},numPages(){const t=this.pageSize;return Math.ceil(this.filtered.length/t)},C1Options(){return Object.entries(V).map(([e,r])=>({label:r,value:Number(e)}))},RtOptions(){return Object.entries(f).map(([e,r])=>({label:r,value:Number(e)})).reverse()},VzOptions(){const t=Object.entries(C).map(([e,r])=>({label:r,value:Number(e)})).reverse();return t.length>0&&t[0]&&(t[0].label="Unknown"),t},SzOptions(){return Object.entries(y).map(([e,r])=>({label:r,value:Number(e)})).reverse()},C2Options(){const t=this.filter.C1??[];if(t.length===0)return Object.entries(p).map(([i,a])=>({label:a,value:Number(i)}));const e={0:[15,21],1:[0,14],2:[22,28],3:[22,28]},r=new Set;for(const i of t){const[a,s]=e[i]??[];for(let o=a;o<=s;o++)r.add(o)}return Object.entries(p).filter(([i])=>r.has(Number(i))).map(([i,a])=>({label:a,value:Number(i)}))},AltOptions(){return Object.entries(m).map(([e,r])=>({label:r,value:Number(e)})).reverse()}},actions:{clearFilter(){this.filter.Rt=void 0,this.filter.Sz=void 0,this.filter.Vz=void 0,this.filter.Cn=void 0,this.filter.C1=void 0,this.filter.C2=void 0,this.filter.Az=void 0,this.filter.Alt=void 0,this.searchFor=""},async catalogFetch(){try{const t=await M.get("/catalog_top25_lg.json");if(t.status!==200)throw new Error(`Unexpected status code: ${t.status}`);const e=t.data;if(!Array.isArray(e))throw new Error("Catalog data is not an array");const r=e.map(i=>({...i,Rating:f[i.Rt],Visibility:R(i.Vz,i.Sz),Constellation:k[i.Cn],Type:D[i.C1],Subtype:p[i.C2],SearchText:g(`${i.MainID} ${i.OtherIDs} ${i.Name}`)}));this.dsos=r}catch{return[]}},updateDsoPositions(){const t=this.site_lat,e=this.site_lon;this.dsos=this.dsos.map(r=>{const{az:i,alt:a}=N(r.RA_hr,r.Dec_deg,t,e),s=T(i),o=_(a);return{...r,Position:w(s,o),Az_deg:i,Alt_deg:a,Az:s,Alt:o}})},startPositionUpdater(){if(n)return;const t=()=>{const e=this.site_lat;typeof this.site_lon=="number"&&typeof e=="number"?(this.updateDsoPositions(),n=setInterval(()=>{this.updateDsoPositions()},900*1e3)):setTimeout(t,1e4)};t()},stopPositionUpdater(){n&&(clearInterval(n),n=null)},updateDsoProximity(t,e){const r=l(d(t)),i=l(e),a=this.dsos.map(s=>{const o=l(d(s.RA_hr)),u=l(s.Dec_deg),S=Math.sin(i)*Math.sin(u)+Math.cos(i)*Math.cos(u)*Math.cos(r-o),b=Math.acos(Math.min(Math.max(S,-1),1)),A=O(b);return{...x(s),Proximity:A}});this.dsos=a}}});function T(t){return Math.floor((t+22.5)%360/45)}function _(t){let e=0;return t<0?e=0:t<15?e=1:t<30?e=2:t<45?e=3:t<60?e=4:t<82?e=5:e=6,e}function w(t,e){const r=j[t].split(" ")[0]??"",i=m[e].split(" ")[0]??"";return e==0||e==6?i:e==1?"At "+r+" "+i:i+" "+r}function R(t,e){const r=C[t].split(" ")[0]??"",i=y[e].split(" ")[0]??"";return t==7&&e==8?"":t==7?i:e==8?r:r+", "+i}const m={0:"Below-Horizon < 0°",1:"Horizon (0–15°)",2:"Low (15–30°)",3:"Mid-Low (30–45°)",4:"Mid-High (45–60°)",5:"High (60–82°)",6:"Near-Zenith > 82°"},j={0:"North",1:"NE",2:"East",3:"SE",4:"South",5:"SW",6:"West",7:"NW"},D={0:"mdi-horse-variant",1:"mdi-cryengine",2:"mdi-blur",3:"mdi-flare"},V={0:"Nebula",1:"Galaxy",2:"Cluster",3:"Star"},f={5:"Top 2%",4:"Top 10%",3:"Top 25%",2:"Typical",1:"Hard",0:"Avoid"},y={0:"Very-Tiny < 0.5′",1:"Tiny (0.5-1′)",2:"Small (1-2′)",3:"Compact (2-5′)",4:"Moderate (5-10′)",5:"Prominent (10-30′)",6:"Extended (30-100′)",7:"Expansive > 100′",8:"Unknown"},C={0:"Ultra-Faint (Mag 12+)",1:"Ghostly (Mag 10 = 12)",2:"Faint (Mag 8 - 10)",3:"Dim (Mag 6 - 8)",4:"Visible (Mag 4 - 6)",5:"Bright (Mag 2 - 4)",6:"Brilliant (Mag <2)",7:"Unknown"},p={0:"Chained Galaxies",1:"Clustered Galaxies",2:"Grouped Galaxies",3:"Merging Galaxies",4:"Pair of Galaxies",5:"Trio of Galaxies",6:"Blue Dwarf",7:"Collisional Ring",8:"Dwarf Galaxy",9:"Elliptical Galaxy",10:"Flocculent Galaxy",11:"Lenticular Galaxy",12:"Magellanic Galaxy",13:"Polar Galaxy",14:"Spiral Galaxy",15:"Dark Nebula",16:"Emission Nebula",17:"Molecular Cloud",18:"Planetary Nebula",19:"Protoplanetary",20:"Reflection Nebula",21:"Supernova Remnant",22:"Globular Cluster",23:"Herbig-Haro Object",24:"Nova Object",25:"Open Cluster",26:"Star",27:"Star Cloud",28:"Young Stellar Object"},k={0:"Andromeda",1:"Antlia",2:"Apus",3:"Aquila",4:"Aquarius",5:"Ara",6:"Aries",7:"Auriga",8:"Boötes",9:"Canis Major",10:"Canis Minor",11:"Canes Venatici",12:"Camelopardalis",13:"Capricornus",14:"Carina",15:"Cassiopeia",16:"Centaurus",17:"Cepheus",18:"Cetus",19:"Chamaeleon",20:"Circinus",21:"Cancer",22:"Columba",23:"Coma Berenices",24:"Corona Australis",25:"Corona Borealis",26:"Crater",27:"Crux",28:"Corvus",29:"Cygnus",30:"Delphinus",31:"Dorado",32:"Draco",33:"Eridanus",34:"Fornax",35:"Gemini",36:"Grus",37:"Hercules",38:"Horologium",39:"Hydra",40:"Leo Minor",41:"Lacerta",42:"Leo",43:"Lepus",44:"Libra",45:"Lupus",46:"Lynx",47:"Lyra",48:"Mensa",49:"Microscopium",50:"Monoceros",51:"Musca",52:"Norma",53:"Octans",54:"Ophiuchus",55:"Orion",56:"Pavo",57:"Pegasus",58:"Perseus",59:"Phoenix",60:"Pictor",61:"Piscis Austrinus",62:"Pisces",63:"Puppis",64:"Pyxis",65:"Reticulum",66:"Sculptor",67:"Scorpius",68:"Scutum",69:"Serpens",70:"Sextans",71:"Sagitta",72:"Sagittarius",73:"Taurus",74:"Telescopium",75:"Triangulum Australe",76:"Triangulum",77:"Tucana",78:"Ursa Major",79:"Ursa Minor",80:"Vela",81:"Virgo",82:"Volans",83:"Vulpecula"};function g(t){return t.toLowerCase().replace(/[^a-z0-9]+/gi," ").trim()}export{I as u};
