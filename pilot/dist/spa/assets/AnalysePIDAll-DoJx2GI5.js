import{Q as C}from"./QSpace-C3nmhAyC.js";import{Q as I}from"./QBtnToggle-ChLIa3X2.js";import{Q as m}from"./QItemLabel-C_mkF9IY.js";import{Q as b,a as _}from"./QItem-KJ1rFUHJ.js";import{d as M,a as L,q as O,z as N,w as z,E,F as o,I as e,J as l,N as c,O as g,T as y,S as P,H as v,P as x,Q as U}from"./index-BwesuDF-.js";import{Q}from"./QList-DW6oSJua.js";import{Q as q}from"./QCard-DdV5PkcJ.js";import{Q as $}from"./QPage-BG-7AJu1.js";import{_ as j}from"./StatusBanners.vue_vue_type_script_setup_true_lang-GQmeRhuH.js";import{C as h}from"./ChartXY-D9cbe8AH.js";import{u as R}from"./stream-CRYyFFVI.js";import{u as H}from"./config-DDH_w1a2.js";import{u as J}from"./device-C4YfQcwg.js";import{_ as X}from"./PIDStatus.vue_vue_type_script_setup_true_lang-D2jGcOfY.js";import"./QBtnGroup-KGBQeF11.js";import"./use-dark-BrWmPCjh.js";import"./status-BlHMPPGz.js";import"./index-DaEgsOZv.js";import"./scale-MATHP_kN.js";import"./angles-gRV9FYwb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QChip-H8mclc7g.js";const Y={class:"row q-pb-sm q-col-gutter-md items-center"},G={class:"q-gutter-md flex justify-end q-mr-md"},W={class:"col-auto q-gutter-sm flex justify-end items-center"},Z={class:"row q-col-gutter-sm items-stretch q-pb-sm"},ee={class:"row q-col-gutter-sm items-stretch"},he=M({__name:"AnalysePIDAll",setup(te){const i=R(),V=H(),D=J(),d=L(2),w=[[{label:"M1",value:0},{label:"M2",value:1},{label:"M3",value:2}],[{label:"Az",value:0},{label:"Alt",value:1},{label:"Roll",value:2}],[{label:"RA ",value:0},{label:"Dec",value:1},{label:"PA ",value:2}]],S=t=>w[d.value]?.[t-1]?.label??"",k=t=>`M${t}`,A=t=>(i.topics?.pid??[]).map(T(t)),F=t=>(i.topics?.pid??[]).map(K(t));function T(t){return a=>{const s=new Date(a.ts),r=a.data;let n,u;d.value===0?(n="θ_pv",u="θ_sp"):d.value===1?(n="α_pv",u="α_sp"):(n="Δ_pv",u="Δ_sp");const p=r[n]?.[t-1]??0,f=r[u]?.[t-1]??0;return{x1:s,PV:p,SP:f}}}function K(t){return a=>{const s=new Date(a.ts),r=a.data,n=r.ω_op[t-1]??0,u=r.ω_kp[t-1]??0,p=r.ω_ki[t-1]??0,f=r.ω_kd[t-1]??0,B=r.ω_ff[t-1]??0;return{x1:s,Kp:u,Ki:p,Kd:f,FF:B,OP:n}}}return O(async()=>{await V.configFetch(),i.subscribe("pid")}),N(()=>{i.unsubscribe("pid")}),z(()=>D.isVisible,t=>{t?i.subscribe("pid"):i.unsubscribe("pid")}),(t,a)=>(v(),E($,{class:"q-pa-sm dark-page"},{default:o(()=>[e(j),l("div",Y,[a[1]||(a[1]=l("div",{class:"col text-h6 q-ml-md"},[c(" Alpaca Driver Performance Analysis "),l("div",{class:"text-caption text-grey-6"}," Use these pages to perform tests and analyse the performance of your Benro Polaris. ")],-1)),e(C),l("div",G,[l("div",W,[e(X),e(I,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=s=>d.value=s),push:"",rounded:"",glossy:"","toggle-color":"primary",options:[{label:"Mot",value:0},{label:"Top",value:1},{label:"Equ",value:2}]},null,8,["modelValue"])])])]),l("div",Z,[(v(),g(P,null,y(3,s=>l("div",{key:s,class:"col-12 col-lg-4 flex"},[e(q,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:o(()=>[e(Q,null,{default:o(()=>[e(b,null,{default:o(()=>[e(_,null,{default:o(()=>[e(m,null,{default:o(()=>[c(x(S(s))+" Angular Position (degrees) vs Time (seconds)",1)]),_:2},1024),e(m,{caption:""},{default:o(()=>a[2]||(a[2]=[c("SP: Setpoint Position, PV: Present Value Position",-1)])),_:1,__:[2]})]),_:2},1024),e(_,{side:""},{default:o(()=>[e(U,{size:"sm",icon:"mdi-chart-bell-curve-cumulative",label:"Tune",to:{path:"/pid",query:{a:s-1}}},null,8,["to"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(h,{data:A(s),x1Type:"time"},null,8,["data"])]),_:2},1024)])),64))]),l("div",ee,[(v(),g(P,null,y(3,s=>l("div",{key:s,class:"col-12 col-lg-4 flex"},[e(q,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:o(()=>[e(Q),e(b,null,{default:o(()=>[e(_,null,{default:o(()=>[e(m,null,{default:o(()=>[c(x(k(s))+" Angular Velocity (degrees/s) vs Time (seconds)",1)]),_:2},1024),e(m,{caption:""},{default:o(()=>a[3]||(a[3]=[c("OP: Output Velocity, Kp: Proportion, Ki: Integral, Kd: Derivative, FF: Feed Forward",-1)])),_:1,__:[3]})]),_:2},1024)]),_:2},1024),e(h,{data:F(s),x1Type:"time"},null,8,["data"])]),_:2},1024)])),64))])]),_:1}))}});export{he as default};
