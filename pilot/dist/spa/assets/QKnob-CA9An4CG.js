import{u as q,Q as H}from"./QCircularProgress-HrTRaIB3.js";import{T as J}from"./TouchPan-BZYOKm2z.js";import{e as L,i as U,a as P,c as l,w as W,ab as X,aa as Y,t as Z,h as _}from"./index-CYMS3cRB.js";import{b as y,n as w}from"./format-BvkBI9bc.js";import{u as p,c as ee}from"./QItem-PkKJGLwX.js";const $=[34,37,40,33,39,38],ae=Object.keys(q),oe=L({name:"QKnob",props:{...p,...q,modelValue:{type:Number,required:!0},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:e=>e>=0},tabindex:{type:[Number,String],default:0},disable:Boolean,readonly:Boolean},emits:["update:modelValue","change","dragValue"],setup(e,{slots:Q,emit:g}){const{proxy:k}=U(),{$q:C}=k,i=P(e.modelValue),h=P(!1),r=l(()=>isNaN(e.innerMin)===!0||e.innerMin<e.min?e.min:e.innerMin),c=l(()=>isNaN(e.innerMax)===!0||e.innerMax>e.max?e.max:e.innerMax);let s;function V(){i.value=e.modelValue===null?r.value:y(e.modelValue,r.value,c.value),f(!0)}W(()=>`${e.modelValue}|${r.value}|${c.value}`,V),V();const d=l(()=>e.disable===!1&&e.readonly===!1),I=l(()=>"q-knob non-selectable"+(d.value===!0?" q-knob--editable":e.disable===!0?" disabled":"")),F=l(()=>(String(e.step).trim().split(".")[1]||"").length),m=l(()=>e.step===0?1:e.step),K=l(()=>e.instantFeedback===!0||h.value===!0),A=C.platform.is.mobile===!0?l(()=>d.value===!0?{onClick:N}:{}):l(()=>d.value===!0?{onMousedown:S,onClick:N,onKeydown:j,onKeyup:D}:{}),B=l(()=>d.value===!0?{tabindex:e.tabindex}:{[`aria-${e.disable===!0?"disabled":"readonly"}`]:"true"}),T=l(()=>{const a={};return ae.forEach(n=>{a[n]=e[n]}),a});function z(a){a.isFinal?(v(a.evt,!0),h.value=!1):(a.isFirst&&(M(),h.value=!0),v(a.evt))}const E=l(()=>[[J,z,void 0,{prevent:!0,stop:!0,mouse:!0}]]);function M(){const{top:a,left:n,width:o,height:b}=k.$el.getBoundingClientRect();s={top:a+b/2,left:n+o/2}}function S(a){M(),v(a)}function N(a){M(),v(a,!0)}function j(a){if($.includes(a.keyCode)===!1)return;X(a);const n=([34,33].includes(a.keyCode)?10:1)*m.value,o=[34,37,40].includes(a.keyCode)?-n:n;i.value=y(parseFloat((i.value+o).toFixed(F.value)),r.value,c.value),f()}function v(a,n){const o=Y(a),b=Math.abs(o.top-s.top),G=Math.sqrt(b**2+Math.abs(o.left-s.left)**2);let t=Math.asin(b/G)*(180/Math.PI);o.top<s.top?t=s.left<o.left?90-t:270+t:t=s.left<o.left?t+90:270-t,C.lang.rtl===!0?t=w(-t-e.angle,0,360):e.angle&&(t=w(t-e.angle,0,360)),e.reverse===!0&&(t=360-t);let u=e.min+t/360*(e.max-e.min);if(m.value!==0){const x=u%m.value;u=u-x+(Math.abs(x)>=m.value/2?(x<0?-1:1)*m.value:0),u=parseFloat(u.toFixed(F.value))}u=y(u,r.value,c.value),g("dragValue",u),i.value!==u&&(i.value=u),f(n)}function D(a){$.includes(a.keyCode)&&f(!0)}function f(a){e.modelValue!==i.value&&g("update:modelValue",i.value),a===!0&&g("change",i.value)}const O=ee(e);function R(){return _("input",O.value)}return()=>{const a={class:I.value,role:"slider","aria-valuemin":r.value,"aria-valuemax":c.value,"aria-valuenow":e.modelValue,...B.value,...T.value,value:i.value,instantFeedback:K.value,...A.value},n={default:Q.default};return d.value===!0&&e.name!==void 0&&(n.internal=R),Z(H,a,n,"knob",d.value,()=>E.value)}}});export{oe as Q};
