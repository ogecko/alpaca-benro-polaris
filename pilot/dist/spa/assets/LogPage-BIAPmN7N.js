import{Q as z}from"./QBadge-CO1yrZtR.js";import{Q as T}from"./QSpace-Cbn5n1AE.js";import{Q as U}from"./QBtnDropdown-DhJt058H.js";import{Q as u}from"./QToggle-B_M-HDHB.js";import{u as G,Q as M}from"./stream-Dwuq1MzQ.js";import{a1 as H,a2 as W,e as j,a as _,y as w,c as A,h as B,X as J,t as K,f as X,d as k,q as O,B as Y,E as I,F as b,J as r,I as s,Y as c,H as h,z as Z,w as Q,N,K as D,O as C,a3 as ee,T as oe,S as te,P as se}from"./index-CZ03DXjz.js";import{a as ne}from"./QScrollArea-B5AUXnQY.js";import{Q as $}from"./QCard-j0TR8eB-.js";import{Q as le}from"./QPage-E42FKURz.js";import{Q as ie}from"./QSelect-pEw8DlSn.js";import{u as re}from"./config-Q1CxDMvj.js";import{u as x}from"./device-BMhOYHwV.js";import{_ as ae}from"./StatusBanners.vue_vue_type_script_setup_true_lang-DhoqC0Bj.js";import"./QBtnGroup-CXtSZjc-.js";import"./QMenu-DhMn_ZMz.js";import"./position-engine-c61Wc2kP.js";import"./selection-D2W554fp.js";import"./focus-manager-DZlw9dCO.js";import"./use-model-toggle-bobRI_2Q.js";import"./use-dark-CEgltGwQ.js";import"./use-timeout-BXG4K7JF.js";import"./use-key-composition-CW69J13u.js";import"./use-checkbox-Di9sDxoK.js";import"./QItem-BtFXUANw.js";import"./status-D38DFJ6c.js";import"./TouchPan-ZkY2FbWG.js";import"./touch-BjYP5sR0.js";import"./format-BvkBI9bc.js";import"./QChip-G3G2U38g.js";import"./QItemLabel-DruX3LLc.js";import"./use-prevent-scroll-CIi6_vxZ.js";import"./rtl-DFPa-2ov.js";const V={threshold:0,root:null,rootMargin:"0px"};function R(o,e,n){let t,d,l;typeof n=="function"?(t=n,d=V,l=e.cfg===void 0):(t=n.handler,d=Object.assign({},V,n.cfg),l=e.cfg===void 0||W(e.cfg,d)===!1),e.handler!==t&&(e.handler=t),l===!0&&(e.cfg=d,e.observer?.unobserve(o),e.observer=new IntersectionObserver(([a])=>{if(typeof e.handler=="function"){if(a.rootBounds===null&&document.body.contains(o)===!0){e.observer.unobserve(o),e.observer.observe(o);return}(e.handler(a,e.observer)===!1||e.once===!0&&a.isIntersecting===!0)&&E(o)}},d),e.observer.observe(o))}function E(o){const e=o.__qvisible;e!==void 0&&(e.observer?.unobserve(o),delete o.__qvisible)}const ce=H({name:"intersection",mounted(o,{modifiers:e,value:n}){const t={once:e.once===!0};R(o,t,n),o.__qvisible=t},updated(o,e){const n=o.__qvisible;n!==void 0&&R(o,n,e.value)},beforeUnmount:E}),ue=j({name:"QIntersection",props:{tag:{type:String,default:"div"},once:Boolean,transition:String,transitionDuration:{type:[String,Number],default:300},ssrPrerender:Boolean,margin:String,threshold:[Number,Array],root:{default:null},disable:Boolean,onVisibility:Function},setup(o,{slots:e,emit:n}){const t=_(w.value===!0?o.ssrPrerender:!1),d=A(()=>o.root!==void 0||o.margin!==void 0||o.threshold!==void 0?{handler:v,cfg:{root:o.root,rootMargin:o.margin,threshold:o.threshold}}:v),l=A(()=>o.disable!==!0&&(w.value!==!0||o.once!==!0||o.ssrPrerender!==!0)),a=A(()=>[[ce,d.value,void 0,{once:o.once}]]),g=A(()=>`--q-transition-duration: ${o.transitionDuration}ms`);function v(f){t.value!==f.isIntersecting&&(t.value=f.isIntersecting,o.onVisibility!==void 0&&n("visibility",t.value))}function p(){if(t.value===!0)return[B("div",{key:"content",style:g.value},X(e.default))];if(e.hidden!==void 0)return[B("div",{key:"hidden",style:g.value},e.hidden())]}return()=>{const f=o.transition?[B(J,{name:"q-transition--"+o.transition},p)]:p();return K(o.tag,{class:"q-intersection"},f,"main",l.value,()=>a.value)}}}),de={class:"row q-mb-md"},me={class:"q-gutter-y-sm"},ge={class:"row"},fe={class:"row"},ve={class:"row"},pe={class:"row"},_e={class:"row"},be={class:"row"},he=k({__name:"LogSettings",setup(o){const e=x(),n=re();O(async()=>{e.restAPIConnected&&e.restAPIConnectedAt&&n.fetchedAt<e.restAPIConnectedAt&&await n.configFetch()});function t(l,a,g){const v=n[l],p=typeof v,f=["string","number","boolean"].includes(p);return{label:a,modelValue:f?v:"","onUpdate:modelValue":y=>{if(y!==null&&f){n[l]=y;const S={[l]:y};d(S)}}}}const d=Y(l=>n.configUpdate(l),5);return(l,a)=>(h(),I($,{flat:"",bordered:"",class:"q-pa-md"},{default:b(()=>[a[0]||(a[0]=r("div",{class:"text-h6"},"Protocol Log Settings",-1)),a[1]||(a[1]=r("div",{class:"row"},[r("div",{class:"col-12 text-caption text-grey-6 q-pb-md"}," Select which messages to log, such as those from Alpaca clients (NINA, CCDciel, Pilot), SynScan apps (Stellarium), and the messages sent to the Benro Polaris. ")],-1)),r("div",de,[s(ie,c({class:"col-12 q-pb-md",filled:""},t("log_level","Log Detail and Verbosity Level"),{options:[{label:"DEBUG – Detailed diagnostic logs",value:"DEBUG"},{label:"INFO – Default routine logging information",value:"INFO"},{label:"WARNING – Only log unexpected issues and above",value:"WARNING"},{label:"ERROR – Only log serious functional problems",value:"ERROR"},{label:"CRITICAL – Only log fatal system errors",value:"CRITICAL"}],"emit-value":"","map-options":""}),null,16)]),r("div",me,[r("div",ge,[s(u,c({class:"col-6"},t("log_alpaca_protocol","Log Alpaca Protocol")),null,16),s(u,c({class:"col-6"},t("log_alpaca_polling","Log Alpaca Polling")),null,16)]),r("div",fe,[s(u,c({class:"col-6"},t("log_alpaca_discovery","Log Alpaca Discovery")),null,16),s(u,c({class:"col-6"},t("log_alpaca_actions","Log Action Invokation")),null,16)]),r("div",ve,[s(u,c({class:"col-6"},t("log_rotator_protocol","Log Rotator Protocol")),null,16),s(u,c({class:"col-6"},t("log_pulse_guiding","Log Pulse Guiding")),null,16)]),r("div",pe,[s(u,c({class:"col-6"},t("log_synscan_protocol","Log SynSCAN Protocol")),null,16),s(u,c({class:"col-6"},t("log_synscan_polling","Log SynSCAN Polling")),null,16)]),r("div",_e,[s(u,c({class:"col-6"},t("log_polaris_protocol","Log Benro Polaris Protocol")),null,16),s(u,c({class:"col-6"},t("log_polaris_polling","Log Benro Polaris Polling")),null,16)]),r("div",be,[s(u,c({class:"col-6"},t("log_polaris_ble","Log Bluetooth Low Energy")),null,16),s(u,c({class:"col-6"},t("log_quest_model","Log Multi-Point Sync")),null,16)])])]),_:1,__:[0,1]}))}}),ye={class:"row q-pb-sm q-col-gutter-md items-center"},Se={class:"col text-h6 q-ml-md"},Pe={key:1,class:"text-caption text-grey-6"},Ae={class:"q-gutter-md flex justify-end q-mr-md"},to=k({__name:"LogPage",setup(o){const e=G(),n=x(),t=A(()=>e.topics.log||[]),d=_(!0),l=_(!0),a=_(null),g=_(null),v=_(0);O(()=>{e.connectSocket(),e.subscribe("log"),S()}),Z(()=>{e.unsubscribe("log")}),Q(()=>n.isVisible,i=>{i?e.subscribe("log"):e.unsubscribe("log")});function p(i){v.value=i.height-50}function f(i){const m=i.ts||"",P=i.level||"",q="text"in i.data?i.data.text:JSON.stringify(i.data);return`[${m}] [${P}] ${q}`}function y(i){d.value=i}function S(){if(!g.value)return;const i=g.value.getScroll(),m=i.verticalSize-i.verticalContainerSize;g.value.setScrollPosition("vertical",m,200)}function L(){l.value=!1}function F(){l.value&&S()}return Q(l,i=>{i&&S()}),(i,m)=>(h(),I(le,{class:"q-pa-sm column"},{default:b(()=>[s(ae),r("div",ye,[r("div",Se,[m[2]||(m[2]=N(" Alpaca Driver Log ",-1)),d.value?(h(),I(z,{key:0,size:"lg",color:"primary"},{default:b(()=>m[1]||(m[1]=[N("Live",-1)])),_:1,__:[1]})):D("",!0),i.$q.screen.gt.xs?(h(),C("div",Pe," Monitor device status, activity, communications, and events in real time ")):D("",!0)]),s(T),r("div",Ae,[s(U,{rounded:"",color:"grey-9",label:"Log Settings","content-style":{width:"600px"}},{default:b(()=>[s(he)]),_:1}),s(u,{dense:"",label:"Live",modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=P=>l.value=P)},null,8,["modelValue"])])]),s($,{ref_key:"cardArea",ref:a,flat:"",bordered:"",class:"col full-height q-pa-md text-body1",style:{"font-family":"monospace"}},{default:b(()=>[s(M,{onResize:p}),s(ne,{ref_key:"scrollArea",ref:g,onScroll:F,style:ee({height:v.value+"px"}),onWheel:L,onClick:L,onPointerdown:L},{default:b(()=>[r("div",null,[(h(!0),C(te,null,oe(t.value,(P,q)=>(h(),C("div",{key:q},se(f(P)),1))),128)),s(ue,{onVisibility:y})])]),_:1},8,["style"])]),_:1},512)]),_:1}))}});export{to as default};
