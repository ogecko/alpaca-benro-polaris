import{Q as T}from"./QBadge-BKdKIeRT.js";import{Q as z}from"./QSpace-hcmkkL3S.js";import{Q as U}from"./QBtnDropdown-DYyw0DPN.js";import{Q as u}from"./QToggle-DF3ISHqv.js";import{u as G,Q as M}from"./stream-BVJeLFz-.js";import{a1 as H,a2 as W,e as j,a as _,y as w,c as P,h as B,X as J,t as K,f as X,d as k,q as O,B as Y,E as I,F as b,J as r,I as s,Y as c,H as h,z as Z,w as Q,N,K as D,O as C,a3 as oo,T as eo,S as to,P as so}from"./index-CabLL4je.js";import{a as lo}from"./QScrollArea-mUGMM2wW.js";import{Q as $}from"./QCard-CZomJhxe.js";import{Q as no}from"./QPage-BNhwHP3i.js";import{Q as io}from"./QSelect-DkiX7vh8.js";import{u as ro}from"./config-rV9RjvCD.js";import{u as x}from"./device-ByMuyERO.js";import{_ as ao}from"./StatusBanners.vue_vue_type_script_setup_true_lang-DdbxGwZD.js";import"./QBtnGroup-BC_XhTa8.js";import"./QMenu-Dq7dYqf3.js";import"./position-engine-mGG91qDE.js";import"./selection-CrbbxkDb.js";import"./focus-manager-BFWwTnJR.js";import"./use-model-toggle-D0RNB08i.js";import"./use-dark-DUyNUrlH.js";import"./use-timeout-CxULoCBv.js";import"./use-key-composition-o7PiexN_.js";import"./use-checkbox-DoaAzbs-.js";import"./QItem-BPivmhBT.js";import"./status-35C9ZYtU.js";import"./TouchPan-BdM62U__.js";import"./touch-BjYP5sR0.js";import"./format-BvkBI9bc.js";import"./QChip-BPiGxopm.js";import"./QItemLabel-BNCLeqRt.js";import"./use-prevent-scroll-BMewW9bI.js";import"./rtl-DFPa-2ov.js";const V={threshold:0,root:null,rootMargin:"0px"};function R(e,o,l){let t,d,n;typeof l=="function"?(t=l,d=V,n=o.cfg===void 0):(t=l.handler,d=Object.assign({},V,l.cfg),n=o.cfg===void 0||W(o.cfg,d)===!1),o.handler!==t&&(o.handler=t),n===!0&&(o.cfg=d,o.observer?.unobserve(e),o.observer=new IntersectionObserver(([a])=>{if(typeof o.handler=="function"){if(a.rootBounds===null&&document.body.contains(e)===!0){o.observer.unobserve(e),o.observer.observe(e);return}(o.handler(a,o.observer)===!1||o.once===!0&&a.isIntersecting===!0)&&E(e)}},d),o.observer.observe(e))}function E(e){const o=e.__qvisible;o!==void 0&&(o.observer?.unobserve(e),delete e.__qvisible)}const co=H({name:"intersection",mounted(e,{modifiers:o,value:l}){const t={once:o.once===!0};R(e,t,l),e.__qvisible=t},updated(e,o){const l=e.__qvisible;l!==void 0&&R(e,l,o.value)},beforeUnmount:E}),uo=j({name:"QIntersection",props:{tag:{type:String,default:"div"},once:Boolean,transition:String,transitionDuration:{type:[String,Number],default:300},ssrPrerender:Boolean,margin:String,threshold:[Number,Array],root:{default:null},disable:Boolean,onVisibility:Function},setup(e,{slots:o,emit:l}){const t=_(w.value===!0?e.ssrPrerender:!1),d=P(()=>e.root!==void 0||e.margin!==void 0||e.threshold!==void 0?{handler:v,cfg:{root:e.root,rootMargin:e.margin,threshold:e.threshold}}:v),n=P(()=>e.disable!==!0&&(w.value!==!0||e.once!==!0||e.ssrPrerender!==!0)),a=P(()=>[[co,d.value,void 0,{once:e.once}]]),f=P(()=>`--q-transition-duration: ${e.transitionDuration}ms`);function v(g){t.value!==g.isIntersecting&&(t.value=g.isIntersecting,e.onVisibility!==void 0&&l("visibility",t.value))}function p(){if(t.value===!0)return[B("div",{key:"content",style:f.value},X(o.default))];if(o.hidden!==void 0)return[B("div",{key:"hidden",style:f.value},o.hidden())]}return()=>{const g=e.transition?[B(J,{name:"q-transition--"+e.transition},p)]:p();return K(e.tag,{class:"q-intersection"},g,"main",n.value,()=>a.value)}}}),mo={class:"row q-mb-md"},go={class:"q-gutter-y-sm"},fo={class:"row"},vo={class:"row"},po={class:"row"},_o={class:"row"},bo={class:"row"},ho={class:"row"},yo=k({__name:"LogSettings",setup(e){const o=x(),l=ro();O(async()=>{o.restAPIConnected&&o.restAPIConnectedAt&&l.fetchedAt<o.restAPIConnectedAt&&await l.configFetch()});function t(n,a,f){const v=l[n],p=typeof v,g=["string","number","boolean"].includes(p);return{label:a,modelValue:g?v:"","onUpdate:modelValue":y=>{if(y!==null&&g){l[n]=y;const S={[n]:y};d(S)}}}}const d=Y(n=>l.configUpdate(n),5);return(n,a)=>(h(),I($,{flat:"",bordered:"",class:"q-pa-md"},{default:b(()=>[a[0]||(a[0]=r("div",{class:"text-h6"},"Protocol Log Settings",-1)),a[1]||(a[1]=r("div",{class:"row"},[r("div",{class:"col-12 text-caption text-grey-6 q-pb-md"}," Select which messages to log, such as those from Alpaca clients (NINA, CCDciel, Pilot), SynScan apps (Stellarium), and the messages sent to the Benro Polaris. ")],-1)),r("div",mo,[s(io,c({class:"col-12 q-pb-md",filled:""},t("log_level","Log Detail and Verbosity Level"),{options:[{label:"DEBUG – Detailed diagnostic logs",value:"DEBUG"},{label:"INFO – Default routine logging information",value:"INFO"},{label:"WARNING – Only log unexpected issues and above",value:"WARNING"},{label:"ERROR – Only log serious functional problems",value:"ERROR"},{label:"CRITICAL – Only log fatal system errors",value:"CRITICAL"}],"emit-value":"","map-options":""}),null,16)]),r("div",go,[r("div",fo,[s(u,c({class:"col-6"},t("log_alpaca_protocol","Log Alpaca Protocol")),null,16),s(u,c({class:"col-6"},t("log_alpaca_polling","Log Alpaca Polling")),null,16)]),r("div",vo,[s(u,c({class:"col-6"},t("log_alpaca_discovery","Log Alpaca Discovery")),null,16),s(u,c({class:"col-6"},t("log_alpaca_actions","Log Action Invokation")),null,16)]),r("div",po,[s(u,c({class:"col-6"},t("log_rotator_protocol","Log Rotator Protocol")),null,16),s(u,c({class:"col-6"},t("log_pulse_guiding","Log Pulse Guiding")),null,16)]),r("div",_o,[s(u,c({class:"col-6"},t("log_synscan_protocol","Log SynSCAN Protocol")),null,16),s(u,c({class:"col-6"},t("log_synscan_polling","Log SynSCAN Polling")),null,16)]),r("div",bo,[s(u,c({class:"col-6"},t("log_polaris_protocol","Log Benro Polaris Protocol")),null,16),s(u,c({class:"col-6"},t("log_polaris_polling","Log Benro Polaris Polling")),null,16)]),r("div",ho,[s(u,c({class:"col-6"},t("log_polaris_ble","Log Bluetooth Low Energy")),null,16),s(u,c({class:"col-6"},t("log_quest_model","Log Multi-Point Sync")),null,16)])])]),_:1,__:[0,1]}))}}),So={class:"row q-pb-sm q-col-gutter-md items-center"},Ao={class:"col text-h6 q-ml-md"},Po={key:1,class:"text-caption text-grey-6"},Lo={class:"q-gutter-md flex justify-end q-mr-md"},se=k({__name:"LogPage",setup(e){const o=G(),l=x(),t=P(()=>o.topics.log||[]),d=_(!0),n=_(!0),a=_(),f=_(),v=_(0);O(()=>{o.connectSocket(),o.subscribe("log"),S()}),Z(()=>{o.unsubscribe("log")}),Q(()=>l.isVisible,i=>{i?o.subscribe("log"):o.unsubscribe("log")});function p(i){console.log("Resize Log",i),v.value=i.height-50}function g(i){const m=i.ts||"",A=i.level||"",q="text"in i.data?i.data.text:JSON.stringify(i.data);return`[${m}] [${A}] ${q}`}function y(i){d.value=i}function S(){const i=f.value.getScroll(),m=i.verticalSize-i.verticalContainerSize;f.value.setScrollPosition("vertical",m,200)}function L(){n.value=!1}function F(){n.value&&S()}return Q(n,i=>{i&&S()}),(i,m)=>(h(),I(no,{class:"q-pa-sm column"},{default:b(()=>[s(ao),r("div",So,[r("div",Ao,[m[2]||(m[2]=N(" Alpaca Driver Log ",-1)),d.value?(h(),I(T,{key:0,size:"lg",color:"primary"},{default:b(()=>m[1]||(m[1]=[N("Live",-1)])),_:1,__:[1]})):D("",!0),i.$q.screen.gt.xs?(h(),C("div",Po," Monitor device status, activity, communications, and events in real time ")):D("",!0)]),s(z),r("div",Lo,[s(U,{rounded:"",color:"grey-9",label:"Log Settings","content-style":{width:"600px"}},{default:b(()=>[s(yo)]),_:1}),s(u,{dense:"",label:"Live",modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=A=>n.value=A)},null,8,["modelValue"])])]),s($,{ref_key:"cardArea",ref:a,flat:"",bordered:"",class:"col full-height q-pa-md text-body1",style:{"font-family":"monospace"}},{default:b(()=>[s(M,{onResize:p}),s(lo,{ref_key:"scrollArea",ref:f,onScroll:F,style:oo({height:v.value+"px"}),onWheel:L,onClick:L,onTouchstart:L},{default:b(()=>[r("div",null,[(h(!0),C(to,null,eo(t.value,(A,q)=>(h(),C("div",{key:q},so(g(A)),1))),128)),s(uo,{onVisibility:y})])]),_:1},8,["style"])]),_:1},512)]),_:1}))}});export{se as default};
