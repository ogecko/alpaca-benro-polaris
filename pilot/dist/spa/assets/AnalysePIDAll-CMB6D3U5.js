import{Q as C}from"./QBtnToggle-CD56g1ca.js";import{Q as m}from"./QItemLabel-DKkNeboc.js";import{Q as b,a as _}from"./QItem-s6vDCOg1.js";import{d as I,a as M,q as L,z as O,w as N,E as z,F as s,I as t,J as r,N as c,O as g,T as y,S as P,H as v,P as x,Q as E}from"./index-Dx5-9Vdh.js";import{Q}from"./QList-B4l1-2kl.js";import{Q as q}from"./QCard-C7HQvmZy.js";import{Q as U}from"./QPage-BWSMpfuG.js";import{_ as $}from"./StatusBanners.vue_vue_type_script_setup_true_lang-CGo07ZQ6.js";import{C as V}from"./ChartXY-Dfoyn3XW.js";import{u as R}from"./stream-CFeLzzJU.js";import{u as j}from"./config-ClasVhDl.js";import{u as H}from"./device-DZEmto42.js";import{_ as J}from"./PIDStatus.vue_vue_type_script_setup_true_lang-WZ1EOD_k.js";import"./QBtnGroup-BoLqx3yL.js";import"./use-dark-T81UEqai.js";import"./status-Bahpu37M.js";import"./index-DaEgsOZv.js";import"./scale-MATHP_kN.js";import"./angles-gRV9FYwb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QChip-lBDG_gZP.js";const X={class:"row q-col-gutter-md items-center q-mb-sm"},Y={class:"col-12 col-md-auto q-gutter-sm flex justify-end items-center q-mr-md"},G={class:"row q-col-gutter-sm items-stretch q-pb-sm"},W={class:"row q-col-gutter-sm items-stretch"},xe=I({__name:"AnalysePIDAll",setup(Z){const i=R(),h=j(),D=H(),d=M(2),w=[[{label:"M1",value:0},{label:"M2",value:1},{label:"M3",value:2}],[{label:"Az",value:0},{label:"Alt",value:1},{label:"Roll",value:2}],[{label:"RA ",value:0},{label:"Dec",value:1},{label:"PA ",value:2}]],k=e=>w[d.value]?.[e-1]?.label??"",A=e=>`M${e}`,S=e=>(i.topics?.pid??[]).map(T(e)),F=e=>(i.topics?.pid??[]).map(K(e));function T(e){return a=>{const o=new Date(a.ts),l=a.data;let n,u;d.value===0?(n="θ_pv",u="θ_sp"):d.value===1?(n="α_pv",u="α_sp"):(n="Δ_pv",u="Δ_sp");const p=l[n]?.[e-1]??0,f=l[u]?.[e-1]??0;return{x1:o,PV:p,SP:f}}}function K(e){return a=>{const o=new Date(a.ts),l=a.data,n=l.ω_op[e-1]??0,u=l.ω_kp[e-1]??0,p=l.ω_ki[e-1]??0,f=l.ω_kd[e-1]??0,B=l.ω_ff[e-1]??0;return{x1:o,Kp:u,Ki:p,Kd:f,FF:B,OP:n}}}return L(async()=>{await h.configFetch(),i.subscribe("pid")}),O(()=>{i.unsubscribe("pid")}),N(()=>D.isVisible,e=>{e?i.subscribe("pid"):i.unsubscribe("pid")}),(e,a)=>(v(),z(U,{class:"q-pa-sm dark-page"},{default:s(()=>[t($),r("div",X,[a[1]||(a[1]=r("div",{class:"col-12 col-md text-h6 q-ml-md"},[c(" Alpaca Driver Performance Analysis "),r("div",{class:"text-caption text-grey-6"}," Use these pages to perform tests and analyse the performance of your Benro Polaris. ")],-1)),r("div",Y,[t(J),t(C,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=o=>d.value=o),push:"",rounded:"",glossy:"","toggle-color":"primary",options:[{label:"Mot",value:0},{label:"Top",value:1},{label:"Equ",value:2}]},null,8,["modelValue"])])]),r("div",G,[(v(),g(P,null,y(3,o=>r("div",{key:o,class:"col-12 col-lg-4 flex"},[t(q,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:s(()=>[t(Q,null,{default:s(()=>[t(b,null,{default:s(()=>[t(_,null,{default:s(()=>[t(m,null,{default:s(()=>[c(x(k(o))+" Angular Position (degrees) vs Time (seconds)",1)]),_:2},1024),t(m,{caption:""},{default:s(()=>a[2]||(a[2]=[c("SP: Setpoint Position, PV: Present Value Position",-1)])),_:1,__:[2]})]),_:2},1024),t(_,{side:""},{default:s(()=>[t(E,{size:"sm",icon:"mdi-chart-bell-curve-cumulative",label:"Tune",to:{path:"/pid",query:{a:o-1}}},null,8,["to"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(V,{data:S(o),x1Type:"time"},null,8,["data"])]),_:2},1024)])),64))]),r("div",W,[(v(),g(P,null,y(3,o=>r("div",{key:o,class:"col-12 col-lg-4 flex"},[t(q,{flat:"",bordered:"",class:"q-pa-md full-width"},{default:s(()=>[t(Q),t(b,null,{default:s(()=>[t(_,null,{default:s(()=>[t(m,null,{default:s(()=>[c(x(A(o))+" Angular Velocity (degrees/s) vs Time (seconds)",1)]),_:2},1024),t(m,{caption:""},{default:s(()=>a[3]||(a[3]=[c("OP: Output Velocity, Kp: Proportion, Ki: Integral, Kd: Derivative, FF: Feed Forward",-1)])),_:1,__:[3]})]),_:2},1024)]),_:2},1024),t(V,{data:F(o),x1Type:"time"},null,8,["data"])]),_:2},1024)])),64))])]),_:1}))}});export{xe as default};
